(this["webpackJsonpaxelor-dms"]=this["webpackJsonpaxelor-dms"]||[]).push([[0],{115:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=115},217:function(e,t,a){e.exports=a(288)},249:function(e,t){},251:function(e,t){},252:function(e,t){},253:function(e,t){},254:function(e,t){},287:function(e,t,a){},288:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),o=a(17),l=a.n(o),c=a(6),s=a(7),u=a(343),d=a(384),m=a(344),f=a(195),p=a(166),v=a.n(p),b=a(167),h=a.n(b),g=a(345),E=Object(u.a)({dangerouslyUseGlobalCSS:!1,productionPrefix:"c"});function C(e){var t=e.direction,a=e.palette,o=e.children;Object(r.useEffect)((function(){t?document.body.dir=t:document.body.removeAttribute("dir")}));var l=function(e){var t=e.direction,a=void 0===t?"ltr":t,r=e.palette;return void 0===n&&(n=document.body.dir||document.dir),a=a||n,Object(f.a)({direction:a,layout:{cols:12},header:{height:64},palette:Object(c.a)({primary:v.a,secondary:h.a},r),typography:{useNextVariants:!0}})}({direction:t,palette:a});return(i.a.createElement(d.b,{generateClassName:E},i.a.createElement(m.a,{theme:l},i.a.createElement(g.a,null),o)))}var O,y=a(16),j=a.n(y),k=a(24),x=a(8),w=a(15),N=a(146),S=a(123),I=a(124),F=a(169),T=a.n(F),L={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json"},P={};function D(e){var t=document.cookie||"";return t!==O&&(O=t,P=t.split("; ").reduce((function(e,t){var a=t.split("=");return e[a[0]]=a[1],e}),{})),P[e]}var B=function(){function e(t){Object(S.a)(this,e),this.domain="",this.baseURL="../"}return Object(I.a)(e,[{key:"request",value:function(e,t,a){var n={};return"get"!==t&&(n.data=a),T()(Object(c.a)({method:t,baseURL:this.baseURL,headers:Object(c.a)({},L,{"X-CSRF-Token":D("CSRF-TOKEN")}),url:e},n))}},{key:"interceptor",value:function(e,t,a){var n=this;return this.request(e,t,a).then((function(r){if(200===r.status)return r.data||{status:r.status};if(401===r.status){var i=localStorage.getItem("credential");if(i){var o=JSON.parse(i),l=o.username,c=o.password;return n.login(l,c).then((function(r){if(200===r.status)return n.interceptor(e,t,a)}))}}return Promise.resolve("Error")})).catch((function(r){if(401===r.response.status)return n.relogin(e,t,a)}))}},{key:"relogin",value:function(e,t,a){var n=this,r=localStorage.getItem("credential");if(r){var i=JSON.parse(r),o=i.username,l=i.password;return this.login(o,l).then((function(r){if(200===r.status)return n.interceptor(e,t,a)}))}}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.interceptor(e,"post",t)}},{key:"delete",value:function(e,t){return this.interceptor(e,"delete",t)}},{key:"login",value:function(e,t){var a={username:e,password:t};return this.interceptor("login.jsp","post",a).then((function(a){return 200===a.status&&localStorage.setItem("credential",JSON.stringify({username:e,password:t})),{status:a.status}}))}},{key:"get",value:function(e){return this.interceptor(e,"get")}},{key:"logout",value:function(){return this.interceptor("logout").then((function(){localStorage.removeItem("credential")}))}},{key:"head",value:function(e,t){var a="".concat(this.baseURL).concat(e),n=new XMLHttpRequest;n.open("GET",a,!0),n.responseType="blob",n.onload=function(e){var a=n.response,r=document.createElement("a");r.href=window.URL.createObjectURL(a),r.download=t,r.click()},n.send()}},{key:"download",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="".concat(this.baseURL,"ws/dms/download/").concat(e.id);return new Promise((function(n,r){var i=new XMLHttpRequest;i.open("GET",a,!0),i.responseType="blob",i.onload=function(a){var r=i.response;if(t)n(r);else{var o=document.createElement("a");o.href=window.URL.createObjectURL(r),o.download=e.isDirectory?"".concat(e.fileName,".zip"):e.fileName,o.click(),n()}},i.send()}))}},{key:"metaFileDownload",value:function(e){var t="".concat(this.baseURL,"ws/rest/com.axelor.meta.db.MetaFile/").concat(e.id,"/content/download"),a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="blob",a.onload=function(t){var n=a.response,r=document.createElement("a");r.href=window.URL.createObjectURL(n),r.download=e.isDirectory?"".concat(e.fileName,".zip"):e.fileName,r.click()},a.send()}},{key:"upload",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((function(i,o){var l=new XMLHttpRequest,c="".concat(e.baseURL,"ws/files/upload"),s=function(){return a["X-File-Id"]?e.interceptor((function(){return e.delete("ws/files/upload/".concat(a["X-File-Id"]))})):Promise.resolve(!0)};l.open("POST",c,!0),Object.keys(a).forEach((function(e){l.setRequestHeader(e,a[e])})),l.withCredentials=!0,l.overrideMimeType("application/octet-stream"),l.setRequestHeader("Content-Type","application/octet-stream"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.setRequestHeader("X-CSRF-Token",D("CSRF-TOKEN")),l.onload=function(){n(100)},r.abort=function(){return l.abort(),s()},l.onreadystatechange=function(){if(4===l.readyState)switch(l.status){case 401:throw new Error("Unauthorized !!");case 200:try{var e=JSON.parse(l.responseText);i(e)}catch(t){i(l.responseText)}break;default:s(),o({status:l.status})}},l.upload.onprogress=function(e){var t=a["X-File-Size"],i=parseFloat(a["X-File-Offset"])+e.loaded,o=Math.round(i/t*100);r.progress=o>95?"95%":o+"%",r.transfer=function(e,t){var a=function(e){return e>1e9?parseFloat(e/1e9).toFixed(2)+" GB":e>1e6?parseFloat(e/1e6).toFixed(2)+" MB":e>=1e3?parseFloat(e/1e3).toFixed(2)+" KB":e+" B"};return a(e||0)+"/"+a(t)}(i,t),r.loaded=i===t,e.lengthComputable&&n(e.loaded/e.total*100,r)},l.send(t)}))}}]),e}(),M=function(e,t){return"ws/rest/".concat(e,"/").concat(t)},V=new B,R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(S.a)(this,e),this.model=t.model}return Object(I.a)(e,[{key:"search",value:function(e){var t=e.fields,a=e.sortBy,n=e.data,r=e.limit,i=e.offset,o=M(this.model,"search");return V.post(o,{fields:t,sortBy:a,data:n,limit:r,offset:i})}},{key:"fetch",value:function(e,t){var a="".concat(e,"/fetch"),n=M(this.model,a);return V.post(n,t)}},{key:"view",value:function(e){return V.post("/ws/meta/view",e)}},{key:"save",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=M(this.model,"");return V.post(a,Object(c.a)({},t?e:{data:e}))}},{key:"removeAll",value:function(e){var t=M(this.model,"removeAll");return V.post(t,{records:e})}},{key:"login",value:function(e,t){return V.login(e,t)}},{key:"logout",value:function(){return V.logout()}},{key:"info",value:function(){return V.get("ws/app/info")}},{key:"action",value:function(e,t){var a="/ws/action/".concat(e);return V.post(a,Object(c.a)({},t,{model:this.model}))}},{key:"export",value:function(e){var t=this,a=e.fields,n=e.sortBy,r=e.data,i=M(this.model,"export");return V.post(i,{fields:a,sortBy:n,data:r}).then((function(e){var a=e.data,n=void 0===a?{}:a,r="export/".concat(n.fileName),i=M(t.model,r);return V.head(i,n.fileName)}))}}]),e}(),z=a(385),U=a(129),W=a.n(U),A=a(128),_=a.n(A),H=a(173),q=a.n(H),K=a(11),G=a.n(K),Y=a(170),X=a(347);var J=function(e){var t=e.item,a=e.menuOptions,n=i.a.useState(),r=Object(s.a)(n,2),o=r[0],l=r[1],c=i.a.useCallback((function(e){0!==a.length&&(e.preventDefault(),l({mouseX:e.clientX-2,mouseY:e.clientY-4}))}),[a]),u=i.a.useCallback((function(){l()}),[]),d=i.a.useCallback((function(e,a){e.stopPropagation(),u(),a.method(t)}),[u,t]);return i.a.createElement("div",{onContextMenu:c},e.children,i.a.createElement(Y.a,{keepMounted:!0,open:Boolean(o),onClose:u,anchorReference:"anchorPosition",anchorPosition:o?{top:o.mouseY,left:o.mouseX}:void 0},a.map((function(e,t){return i.a.createElement(X.a,{key:t,onClick:function(t){return d(t,e)}},e.title)}))))},Q=a(348),$=a(349),Z=a(350),ee=a(352),te=a(295),ae=a(351),ne="PENDING",re="COMPLETED",ie="CANCEL";function oe(e){return 0===e.indexOf("-")?"desc":"asc"}function le(e){return 0===e.indexOf("-")?e.substring(1):e}function ce(e){var t=new B({});return"".concat(t.domain).concat(t.baseURL,"ws/dms/inline/").concat(e)}function se(e){var t=new B({});return"".concat(t.baseURL,"ws/dms/download/").concat(e)}function ue(e){return window._t&&"string"===typeof e?window._t(e):e}var de=Object(z.a)((function(e){return{form:{display:"flex",flexDirection:"column"},input:{marginBottom:25}}}));var me=function(e){var t=e.onClose,a=e.open,n=e.onSave,r=i.a.useState(""),o=Object(s.a)(r,2),l=o[0],c=o[1],u=de(),d=i.a.useCallback((function(e){c(e.target.value)}),[]),m=i.a.useCallback((function(e){c(""),t()}),[t]),f=i.a.useCallback((function(e){""!==l?(n(l),c("")):alert(ue("Folder name is required"))}),[l,n]);return i.a.createElement(Q.a,{onClose:m,"aria-labelledby":"simple-dialog-title",open:a,maxWidth:"xs",fullWidth:!0},i.a.createElement($.a,null,ue("New folder")),i.a.createElement(Z.a,{className:u.form},i.a.createElement(ae.a,{className:u.input,name:"name",value:l,onChange:d,placeholder:ue("Folder name")})),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:f,variant:"contained",color:"primary"},ue("Save")),i.a.createElement(te.a,{onClick:m,variant:"outlined"},ue("Cancel"))))},fe=[{name:"fileName",title:"File Name",type:"STRING"},{name:"content",title:"Content",type:"STRING"},{name:"contentType",title:"Content type",type:"STRING"},{name:"createdOn",title:"Created on",type:"DATETIME"},{name:"createdBy",title:"Created by",type:"MANY_TO_ONE",target:"com.axelor.auth.db.User",targetName:"fullName"},{name:"importId",title:"Import ID",type:"STRING"},{name:"isDirectory",title:"Is directory",type:"BOOLEAN"},{name:"updatedOn",title:"Updated on",type:"DATETIME"},{name:"updatedBy",title:"Updated by",type:"MANY_TO_ONE",target:"com.axelor.auth.db.User",targetName:"fullName"},{name:"tag",title:"Tag",type:"MANY_TO_MANY",target:"com.axelor.dms.db.DMSFileTag",targetName:"name"},{name:"importOrigin",title:"Imported from",type:"STRING"}],pe=[{title:ue("Can read"),id:"READ"},{title:ue("Can write"),id:"WRITE"},{title:ue("Can share"),id:"FULL"}],ve=Object(z.a)((function(e){return{dmsTreeContainer:{width:300,paddingRight:10,maxHeight:"60%",marginBottom:15,overflow:"auto"},treeElement:{padding:5,display:"flex"},treeElementContainer:{cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, .05)"}},selected:{backgroundColor:"rgba(0, 0, 0, .03)"},expandIcon:{marginTop:-3,cursor:"pointer"},folderIcon:{fontSize:"1.3rem",marginRight:5},noChildren:{paddingLeft:24}}}));function be(e){var t=ve(),a=!1===e.isCollapse?_.a:W.a;return i.a.createElement(a,{className:t.expandIcon,onClick:e.onClick})}var he=function(e){var t=e.data,a=e.currentFolder,n=e.handleFolder,o=e.onFolderCreate,l=ve(),c=Object(r.useState)([]),u=Object(s.a)(c,2),d=u[0],m=u[1],f=i.a.useState(),p=Object(s.a)(f,2),v=p[0],b=p[1],h=i.a.useCallback((function(e,t){var a=t.id;e&&e.stopPropagation();var n=!0;a&&m((function(e){var t=e.indexOf(a);return n&&(n=!1,t>-1?e.splice(t,1):e.push(a)),Object(x.a)(e)}))}),[]),g=i.a.useCallback((function(e,t){n(t)}),[n]),E=i.a.useCallback((function(e){var t={fileName:e,isDirectory:!0,relatedId:v.relatedId,relatedModel:v.relatedModel,parent:{id:v.id},favouriteUserSet:[]};o(t),b()}),[o,v]),C=i.a.useCallback((function(e){b(e)}),[]),O=i.a.useCallback((function(){b()}),[]),y=[{title:"New Folder",method:C}];Object(r.useEffect)((function(){h(null,{id:a})}),[a,h]);var j=t&&t[0];return(i.a.createElement("div",{className:l.dmsTreeContainer},j&&function e(n,r){return n.map((function(n,o){var c=function(e,t,a){return e.filter((function(e){return e[a]===t}))}(t,n.id,"parent.id"),s=!d.includes(n.id);return i.a.createElement(i.a.Fragment,{key:o},i.a.createElement(J,{menuOptions:y,item:n},i.a.createElement("div",{className:G()(l.treeElementContainer,n.id===a&&l.selected),onClick:function(e){return g(e,n)}},i.a.createElement("div",{className:G()(l.treeElement,Object(w.a)({},l.noChildren,0===c.length)),style:{marginLeft:15*r}},c.length>0&&i.a.createElement(be,{onClick:function(e){return h(e,n)},isCollapse:s}),i.a.createElement(q.a,{className:l.folderIcon}),i.a.createElement("span",null,n.fileName))),!s&&e(c,r+1)))}))}([j],1),i.a.createElement(me,{onClose:O,open:Boolean(v),onSave:E})))},ge=a(96),Ee=a(388),Ce=a(354),Oe=a(383),ye=a(132),je=a(179),ke=a.n(je),xe=a(174),we=a.n(xe),Ne=a(175),Se=a.n(Ne),Ie=a(62),Fe=a.n(Ie),Te=Object(z.a)((function(e){return{noDocumentsFound:{display:"flex",justifyContent:"center",width:"100%"},listContainer:{width:"100%",height:"100%"},listHeaderContainer:{padding:10,display:"flex"},listContentContainer:{overflow:"auto",height:"calc(100% - 120px)"},listHeaderCell:{padding:5,display:"flex"},sortIcon:{width:"0.90em",height:"0.90em",marginTop:2,marginLeft:5},recordLine:{display:"flex",padding:10,borderBottom:"1px solid rgb(224,224,224)","&:hover":{backgroundColor:"rgba(0, 0, 0, .05)"}},selectedRecordLine:{backgroundColor:"rgba(0, 0, 0, 0.2) !important"},ellipseTypo:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},ellipse:{whiteSpace:"nowrap"},columnTitle:{textTransform:"capitalize"}}})),Le=[{name:"typeIcon",title:"",width:"34px"},{name:"fileName",title:"File Name",width:"50%",canSort:!0},{name:"updatedOn",title:"Updated On",width:"15%",canSort:!0},{name:"updatedBy",title:"Updated By",width:"15%",canSort:!0},{name:"metaFile.sizeText",title:"File Size",width:"15%",canSort:!0}],Pe=function(e,t){if(!t.canWrite){var a=e.findIndex((function(e){return e.title===ue("Delete")}));e.splice(a,1)}return e},De=function(e){var t=e.selectedFiles,a=e.onSorting,n=e.sortingField,o=void 0===n?"":n,l=e.menuOptions,c=e.fields,s=e.data,u=e.onClick,d=Te(),m=function(e){return-1!==t.findIndex((function(t){return t.id===e.id}))},f=[].concat(Le,Object(x.a)(c)),p=Object(r.useCallback)((function(e){var t=o.indexOf(e.name);a(0===t?"-".concat(e.name):e.name)}),[o,a]);return i.a.createElement("div",{className:d.listContainer},s&&0!==s.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:d.listHeaderContainer},f.map((function(e,t){return i.a.createElement("div",{key:t,className:d.listHeaderCell,style:{width:e.width},onClick:function(){return e.canSort&&p(e)}},i.a.createElement(ge.a,{noWrap:!0,className:d.columnTitle},e.title),le(o)===e.name&&i.a.createElement(i.a.Fragment,null,"desc"===oe(o)?i.a.createElement(we.a,{className:d.sortIcon}):i.a.createElement(Se.a,{className:d.sortIcon})))}))),i.a.createElement("div",{className:d.listContentContainer},s.map((function(e){return i.a.createElement(J,{key:e.id,menuOptions:Pe(l,e),item:e},i.a.createElement("div",{className:G()(d.recordLine,m(e)&&d.selectedRecordLine),onClick:function(t){return u(t,e)}},f.map((function(t,a){return i.a.createElement("div",{key:a,className:G()(d.listHeaderCell,d.ellipse),style:{width:t.width}},"typeIcon"===t.name?i.a.createElement("i",{className:e[t.name],style:{alignSelf:"center"}}):i.a.createElement(ge.a,{noWrap:!0,className:d.ellipseTypo},"updatedOn"===t.name?Fe()(e.updatedOn).format("L LT"):(n=e[t.name])&&"object"===typeof n?n.fullName:n));var n}))))})))):i.a.createElement("div",{className:d.noDocumentsFound},ue("No documents found.")))},Be=a(177),Me=a.n(Be),Ve=a(176),Re=a.n(Ve),ze=a(353),Ue=Object(N.a)((function(e){return{noDocumentsFound:{display:"flex",justifyContent:"center",width:"100%"},listContainer:{width:"100%",height:"100%"},listHeaderContainer:{padding:10,display:"flex"},listContentContainer:Object(w.a)({display:"flex",flexWrap:"wrap",height:"calc(100% - 75px)",overflow:"auto",alignContent:"baseline"},e.breakpoints.only("xs"),{justifyContent:"center"}),listHeaderCell:{padding:5},recordLine:{display:"flex",padding:10,border:"1px solid rgb(224,224,224)",margin:"10px 0 0 10px",borderRadius:2,width:350,height:75,"&:hover":{backgroundColor:"rgba(0, 0, 0, .05)"}},selectedRecordLine:{backgroundColor:"rgba(0, 0, 0, 0.2) !important"},ellipseTypo:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},ellipse:{whiteSpace:"nowrap"},imageIconView:{display:"flex",alignItems:"center",justifyContent:"center",width:50,height:"100%",alignSelf:"center"},fileName:{fontSize:"12px !important",fontWeight:"bold !important"},updatedText:{fontSize:"12px !important"},infoContainer:{display:"flex",maxWidth:"calc(100% - 50px - 8px)",marginLeft:8,flexDirection:"column",justifyContent:"space-between",flex:1},infoRow:{display:"flex",justifyContent:"space-between"},actionView:{height:20},actionIcon:{width:20,height:20,cursor:"pointer"},selectedStar:{color:ze.a[500]},thumbnailImage:{maxWidth:"100%",maxHeight:"100%"},thumbnailTypeIcon:{fontSize:50,display:"flex",justifyContent:"center"}}})),We=function(e){var t=e.item,a=Ue();return t.id?t.fileType&&-1!==t.fileType.indexOf("image")?i.a.createElement("img",{src:ce(t.id),alt:ue("Thumbnail"),className:a.thumbnailImage}):i.a.createElement("i",{className:G()(t.typeIcon,a.thumbnailTypeIcon)}):null},Ae=function(e){var t=e.menuOptions,a=e.userId,n=e.selectedFiles,r=e.onClick,o=e.data,l=e.handleFavourite,c=Ue(),s=function(e){return-1!==n.findIndex((function(t){return t.id===e.id}))};return i.a.createElement("div",{className:c.listContainer},o&&0!==o.length?i.a.createElement("div",{className:c.listContentContainer},o.map((function(e){return i.a.createElement(J,{key:e.id,menuOptions:t,item:e},i.a.createElement("div",{className:G()(c.recordLine,s(e)&&c.selectedRecordLine),onClick:function(t){return r(t,e)}},i.a.createElement("div",{className:c.imageIconView},i.a.createElement(We,{item:e})),i.a.createElement("div",{className:c.infoContainer},i.a.createElement("div",{className:G()(c.ellipse)},i.a.createElement(ge.a,{className:G()(c.ellipseTypo,c.fileName)},e.fileName)),i.a.createElement("div",{className:G()(c.ellipse,c.infoRow)},i.a.createElement(ge.a,{className:G()(c.ellipseTypo,c.updatedText)},Fe()(e.updatedOn).format("L LT")),i.a.createElement("div",{className:G()(c.actionView),onClick:function(t){return function(e,t){e.stopPropagation(),l(t)}(t,e)}},function(e,t){return-1!==e.favouriteUserSet.findIndex((function(e){return e.id===t}))}(e,a)?i.a.createElement(Re.a,{className:G()(c.actionIcon,c.selectedStar)}):i.a.createElement(Me.a,{className:c.actionIcon}))))))}))):i.a.createElement("div",{className:c.noDocumentsFound},ue("No documents found.")))},_e=Object(z.a)((function(e){return{form:{display:"flex",flexDirection:"column"},input:{marginBottom:25}}}));var He=function(e){var t=e.onClose,a=e.open,n=e.onConfirm,r=_e(),o=i.a.useCallback((function(e){t()}),[t]);return i.a.createElement(Q.a,{onClose:o,"aria-labelledby":"simple-dialog-title",open:a,maxWidth:"xs",fullWidth:!0},i.a.createElement($.a,null,ue("Question")),i.a.createElement(Z.a,{className:r.form},i.a.createElement(ge.a,null,ue("Are you sure you want to delete"),"?"),i.a.createElement(ge.a,null,ue("All old versions will also removed."))),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:n,variant:"contained",color:"primary"},ue("Delete")),i.a.createElement(te.a,{onClick:o,variant:"outlined"},ue("Cancel"))))},qe=Object(z.a)((function(e){return{gridViewWrapper:{width:"100%",position:"relative",height:"100%"},dropOverlayContainer:{position:"absolute",backgroundColor:"rgba(0,0,0,0.2)",width:"100%",top:0,left:0,height:"100%"},homeCrumb:{display:"flex",alignItems:"center"},homeIcon:{marginRight:5,color:"#0088cc"},crumbTypo:{lineHeight:2,color:"#0088cc",cursor:"pointer",borderBottom:"1px solid transparent","&:hover":{borderBottom:"1px solid #0088cc"}},lastCrumbTypo:{cursor:"auto",borderBottom:"none","&:hover":{borderBottom:"none"}},breadcrumb:{padding:20,"& > ol":{flexWrap:"noWrap",whiteSpace:"noWrap",overflow:"auto"}}}}));function Ke(){var e=qe();return(i.a.createElement("div",{className:e.dropOverlayContainer}))}var Ge=function(e){var t=qe(),a=i.a.useRef(null),n=e.viewMode,r=e.onSelect,o=e.onFolderDoubleClick,l=e.selectedFiles,u=e.sortingField,d=e.onDelete,m=e.breadcrumb,f=e.userId,p=e.onFavouriteDocument,v=e.customFields,b=i.a.useState(0),h=Object(s.a)(b,2),g=h[0],E=h[1],C=i.a.useState(),O=Object(s.a)(C,2),y=O[0],j=O[1],k=i.a.useState(),x=Object(s.a)(k,2),N=x[0],S=x[1],I=i.a.useCallback((function(){var e=y.record;e.isDirectory&&o(e)}),[o,y]),F=i.a.useCallback((function(){var e=y.e,t=y.record;r(t,e.ctrlKey)}),[r,y]),T=i.a.useCallback((function(e,t){E((function(e){return e+1})),j({e:Object(c.a)({},e),record:t})}),[]);i.a.useEffect((function(){var e;return 1===g?e=setTimeout((function(){F(),E(0)}),250):2===g&&(I(),E(0)),function(){return clearTimeout(e)}}),[g,I,F]);var L=i.a.useCallback((function(e){S(e)}),[]),P=i.a.useCallback((function(){d(N),S()}),[N,d]),D=i.a.useCallback((function(){S()}),[]),B=i.a.useCallback((function(e){o(e)}),[o]),M=i.a.useCallback((function(e,a){return i.a.createElement(ge.a,{key:e.id,className:G()(t.crumbTypo,Object(w.a)({},t.lastCrumbTypo,a)),onClick:function(t){return!a&&B(e)}},e.fileName)}),[B,t]),V=i.a.useCallback((function(e){p(e)}),[p]),R=i.a.useCallback((function(){return v.map((function(e){return{name:"".concat(e.modelField,".").concat(e.name),minWidth:"15%",title:e.name,canSort:!0}}))}),[v]),z=Object(Oe.a)({accept:[ye.a.FILE],drop:function(t,a){e.handleFileUpload(a.getItem().files)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),U=Object(s.a)(z,2),W=U[0];(0,U[1])(a);var A=[{title:ue("Delete"),method:L},{title:ue("Favourite"),method:V}];return(i.a.createElement("div",{ref:a,className:t.gridViewWrapper},W.isOver&&W.canDrop&&i.a.createElement(Ke,null),i.a.createElement(Ee.a,{classes:{root:t.breadcrumb},"aria-label":"breadcrumb"},m.map((function(e,a){return 0===a?i.a.createElement(Ce.a,{key:e.id,className:t.homeCrumb},i.a.createElement(ke.a,{className:t.homeIcon}),M(e,m.length-1===a)):M(e,m.length-1===a)}))),"list"===n?i.a.createElement(De,{menuOptions:A,data:e.data,onClick:T,selectedFiles:l,onSorting:e.onSorting,sortingField:u,userId:f,fields:R()}):i.a.createElement(Ae,{menuOptions:A,data:e.data,onClick:T,selectedFiles:l,onSorting:e.onSorting,sortingField:u,userId:f,handleFavourite:V}),i.a.createElement(He,{open:Boolean(N),onConfirm:P,onClose:D})))},Ye=a(381),Xe=a(196),Je=a(356),Qe=a(389);function $e(e){var t=e.DesktopView,a=e.MobileView,n=e.viewProps,r=e.desktopViewProps,o=e.mobileViewProps;return(i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe.a,{only:"xs"},i.a.createElement(t,Object.assign({},n,r))),i.a.createElement(Qe.a,{smUp:!0},i.a.createElement(a,Object.assign({},n,o)))))}$e.defaultProps={DesktopView:function(){},MobileView:function(){},desktopViewProps:{},mobileViewProps:{},viewProps:{}};var Ze=$e,et=a(296),tt=i.a.forwardRef((function(e,t){return i.a.createElement(et.a,Object.assign({direction:"left",ref:t},e))})),at=Object(z.a)((function(e){return{uploadViewContainer:{position:"absolute",bottom:20,right:20,width:600,minHeight:150,maxHeight:500,zIndex:9999},uploadViewCard:{width:"100%",height:"100%"},uploadList:{overflow:"auto",padding:5,maxHeight:450},fileInfoView:{display:"flex",justifyContent:"flex-end",padding:"5px 0px"},progressView:{width:150,height:20,margin:5},fileNameText:{lineHeight:2},titleView:{padding:10,borderBottom:"2px solid #ddd"},actionText:{textTransform:"capitalize !important"},actionButton:{padding:"0px !important"}}}));function nt(e){var t=e.droppedFiles,a=e.cancelUpload,n=e.retryUpload,r=at(),o=i.a.useState(!1),l=Object(s.a)(o,2),c=l[0],u=l[1];i.a.useEffect((function(){t.length>0?u(!0):u(!1)}),[t]);var d=i.a.useCallback((function(){u(!1)}),[]);return(i.a.createElement(Q.a,{onClose:d,"aria-labelledby":"simple-dialog-title",open:c,fullScreen:!0,TransitionComponent:tt},i.a.createElement($.a,null,ue("Upload completed")),i.a.createElement(Z.a,null,t.map((function(e,t){return i.a.createElement("div",{key:t,className:r.fileInfoView},i.a.createElement(ge.a,{className:r.fileNameText,noWrap:!0},e.file.name),i.a.createElement(Je.a,{className:r.progressView,variant:"determinate",value:e.progress}),i.a.createElement("div",{className:r.actionView},e.status===ne&&i.a.createElement(te.a,{className:r.actionButton,variant:"outlined",onClick:function(){return a(e.id)}},i.a.createElement(ge.a,{className:r.actionText},ue("Cancel"))),e.status===ie&&i.a.createElement(te.a,{className:r.actionButton,variant:"outlined",onClick:function(){return n(e.id)}},i.a.createElement(ge.a,{className:r.actionText},ue("Retry")))))})))))}function rt(e){var t=e.droppedFiles,a=e.cancelUpload,n=e.retryUpload,r=at();return t.length?i.a.createElement("div",{className:r.uploadViewContainer},i.a.createElement(Xe.a,{className:r.uploadViewCard},i.a.createElement("div",{className:r.titleView},i.a.createElement(ge.a,null,ue("Upload completed"))),i.a.createElement("div",{className:r.uploadList},t.map((function(e,t){return i.a.createElement("div",{key:t,className:r.fileInfoView},i.a.createElement("span",{className:r.fileNameText},e.file.name),i.a.createElement(Je.a,{className:r.progressView,variant:"determinate",value:e.progress}),i.a.createElement("div",{className:r.actionView},e.status===ne&&i.a.createElement(te.a,{className:r.actionButton,variant:"outlined",onClick:function(){return a(e.id)}},i.a.createElement(ge.a,{className:r.actionText},ue("Cancel"))),e.status===ie&&i.a.createElement(te.a,{className:r.actionButton,variant:"outlined",onClick:function(){return n(e.id)}},i.a.createElement(ge.a,{className:r.actionText},ue("Retry")))))}))))):null}var it=function(e){return i.a.createElement(Ze,{DesktopView:rt,MobileView:nt,viewProps:Object(c.a)({},e)})},ot=a(301),lt=a(367),ct=a(292),st=a(297),ut=a(369),dt=a(293),mt=a(294),ft=a(3),pt=a(357),vt=a(370),bt=a(371),ht=a(372),gt=a(373),Et=a(374),Ct=a(375),Ot=a(376),yt=a(362),jt=a(365),kt=a(368),xt=a(358),wt=a(364),Nt=a(23),St=a(391),It=Object(N.a)((function(e){return{root:{display:"flex",borderBottom:"solid 1px rgba(0, 0, 0, 0.54)",marginBottom:"7px"},chip:{margin:"4px",height:30},list:{display:"flex",padding:"0 !important"},listItem:{padding:"0 !important"},divider:{width:1,height:28,margin:4},buttonContainer:{display:"flex",width:"100%",justifyContent:"flex-end",alignItems:"center",position:"relative",bottom:-3},inputIconBtn:{margin:0,padding:0,color:"#bbb"}}}));function Ft(e){var t=e.value,a=e.onDelete,n=e.filters,r=e.handleClick,o=(Object(Nt.a)(e,["value","onDelete","filters","handleClick"]),It()),l="";if(t.length>1)l="Filters ".concat(t.length);else if(t.length){var c=n.find((function(e){return e.id===t[0]}));l=c?c.title:ue("Custom")}return(i.a.createElement("div",{className:o.root},i.a.createElement(dt.a,{className:o.list},i.a.createElement(St.a,{label:l,onDelete:function(){return a(t)},className:o.chip})),i.a.createElement("div",{className:o.buttonContainer},i.a.createElement(st.a,{"aria-label":"open",onClick:r,className:o.inputIconBtn},i.a.createElement(pt.a,null)),i.a.createElement(st.a,{"aria-label":"refresh",className:o.inputIconBtn},i.a.createElement(xt.a,null)))))}var Tt=a(180),Lt=a(105),Pt=a(181),Dt=a(182),Bt=a(183);Lt.b.add(Pt.a,Dt.a,Bt.a);var Mt=Tt.a,Vt=a(299),Rt=a(355),zt=a(359),Ut=a(68),Wt=Object(N.a)((function(e){return{container:{display:"flex",justifyContent:"center",flexDirection:"column"},subtitle1:{fontSize:12},chip:{margin:e.spacing(.5,.25)},link:{cursor:"pointer"},mobleString:{alignItems:"flex-start !important",padding:5}}}));function At(e){var t=e.title,a=e.value,n=Wt(),r=Object(Ut.a)(),o=Object(Rt.a)(r.breakpoints.up("sm"));return i.a.createElement("div",{className:G()(n.container,Object(w.a)({},n.mobleString,!o))},i.a.createElement(ge.a,{variant:"subtitle1",className:n.subtitle1},t),i.a.createElement(ge.a,null,a))}function _t(e){var t=e.title,a=e.value,n=e.optionLabelKey,r=e.viewRecord,o=Wt();function l(e){var t=e&&e[n];return t&&i.a.createElement(zt.a,{className:o.link,onClick:function(){return r&&r(e)}},t)}return Array.isArray(a)?i.a.createElement("div",null,i.a.createElement(ge.a,{variant:"subtitle1",className:o.subtitle1},t),a.map((function(e,t){return i.a.createElement(St.a,{key:t,label:l(e),className:o.chip})}))):i.a.createElement("div",null,i.a.createElement(ge.a,{variant:"subtitle1",className:o.subtitle1},t),a&&l(a))}function Ht(e){var t=e.title,a=e.value,n=e.customRender;return"object"!==typeof a||n?i.a.createElement(At,{title:t,value:a}):i.a.createElement(_t,e)}function qt(e){var t=e.name,a=e.title,n=e.autoTitle,r=e.value,o=void 0===r?"":r,l=e.onChange,u=e.onBlur,d=e.readOnly,m=e.inline,f=e.InputProps,p=e.style,v=e.isControlled,b=void 0===v||v,h=Object(Nt.a)(e,["name","title","autoTitle","value","onChange","onBlur","readOnly","inline","InputProps","style","isControlled"]),g=i.a.useState(o),E=Object(s.a)(g,2),C=E[0],O=E[1];function y(e){l(C),u&&u(e)}function j(e){var t=e.target.value;b?O(t):l(t)}return i.a.useEffect((function(){O(o)}),[o]),m?d?i.a.createElement(Ht,{value:C}):i.a.createElement(ae.a,Object.assign({style:Object(c.a)({width:"100%"},p),placeholder:a,inputProps:{"aria-label":a},name:t,onChange:j,onBlur:y,autoComplete:"off",readOnly:d,disabled:d,value:C||""},h)):d?i.a.createElement(Ht,{title:a,value:C}):i.a.createElement(Vt.a,Object.assign({id:"filled-".concat(t),label:a||n,name:t,style:Object(c.a)({width:"100%"},p),onChange:j,onBlur:y,autoComplete:"off",fullWidth:!0,InputProps:Object(c.a)({readOnly:d},f),value:C||"",className:h.className},h))}qt.defaultProps={rows:3,readOnly:!1};var Kt=qt,Gt=a(366),Yt=a(133),Xt=a(393),Jt=a(361),Qt=a(390),$t=a(387);function Zt(e){var t=e.title,a=e.className,n=e.onClick,r=Object(Nt.a)(e,["title","className","onClick"]);return t&&i.a.createElement(zt.a,Object.assign({component:"button",variant:"body2",onClick:n,className:a},r),t)}function ea(e){var t=e.name,a=e.className,n=e.onChange,r=e.value,o=e.classes,l=e.data;return(i.a.createElement(Xt.a,{"aria-label":t,name:t,className:a,value:r,onChange:function(e){return n(e)}},l.map((function(e,t){var a=e.value,n=e.label;return(i.a.createElement(Jt.a,{key:t,value:a,control:i.a.createElement(Qt.a,null),label:n,classes:{label:o&&o.label}}))}))))}function ta(e){var t=e.name,a=e.value,n=e.onChange,r=e.title,o=e.inline,l=void 0!==o&&o,c=e.isDisabled,s=e.classes,u=Object(Nt.a)(e,["name","value","onChange","title","inline","isDisabled","classes"]);return l?i.a.createElement($t.a,Object.assign({checked:Boolean(a),onChange:function(e){var t=e.target.checked;return n(t)},value:t,name:t,disabled:c},u)):i.a.createElement(Jt.a,{control:i.a.createElement($t.a,{checked:Boolean(a),onChange:function(e){var a=e.target.checked;return n({name:t,checked:a})},value:t}),label:r,classes:{label:s&&s.label}})}function aa(e){var t=e.classes,a=e.onClick,n=e.title,r=e.hide,o=e.className,l=Object(Nt.a)(e,["classes","onClick","title","hide","className"]);return(i.a.createElement(te.a,Object.assign({variant:"contained",color:"primary",className:G()(t.button,o),onClick:a},l,{style:r?{display:"none"}:{}}),n))}var na=a(386),ra=Object(N.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},select:{width:"150px"}}}));function ia(e){var t=e.name,a=e.value,n=void 0===a?"":a,r=e.onChange,o=e.options,l=Object(Nt.a)(e,["name","value","onChange","options"]),c=ra();return i.a.createElement(na.a,Object.assign({value:n,onChange:function(e){return r(e.target.value)},name:t,style:{marginRight:8},classes:{select:c.select}},l),o&&o.map((function(e,t){var a=e.name,n=e.title;return(i.a.createElement(X.a,{value:a,key:t},n))})))}var oa=a(360),la=a(184),ca=a(185),sa=a.n(ca),ua=a(187),da=a.n(ua),ma=a(194);var fa=Object(z.a)((function(e){return{formControl:{width:"100%",position:"relative","&.inline":{marginTop:3},".inline &":{paddingBottom:3}},inputRoot:{"& > div":{marginTop:"12px"}},root:{flexGrow:1},inputWrapper:{".inline & > *":{paddingBottom:3}},input:{display:"flex",padding:0,textOverflow:"ellipsis",position:"relative",whiteSpace:"nowrap",height:36,".single":{height:36},".inline &":{height:26}},valueContainer:{position:"relative",display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden",".single > &":{flexWrap:"nowrap"},".inline &":{flexWrap:"nowrap"}},chip:{margin:e.spacing(.5,.25)},chipFocused:{backgroundColor:Object(la.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16,textOverflow:"ellipsis",overflow:"hidden"},placeholder:{position:"absolute",left:2,bottom:6,fontSize:16,".inline &":{bottom:1}},divider:{height:e.spacing(2)},viewIcon:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",right:70,bottom:8,zIndex:1,cursor:"pointer","& svg":{fontSize:20,color:"#ddd","&:hover":{color:"#555"}}}}}));function pa(e){var t=e.inputRef,a=Object(Nt.a)(e,["inputRef"]);return(i.a.createElement("div",Object.assign({ref:t},a)))}var va={Control:function(e){var t=e.children,a=e.innerProps,n=e.innerRef,r=e.selectProps,o=r.classes,l=r.isMulti,s=r.TextFieldProps,u=r.InputProps;return(i.a.createElement(Vt.a,Object.assign({className:o.inputWrapper,fullWidth:!0,classes:Object(c.a)({},s&&s.label&&{root:o.inputRoot}),InputProps:Object(c.a)({},u,{inputComponent:pa,inputProps:Object(c.a)({className:G()(o.input,{single:!l}),ref:n,children:t},a)})},s)))},MultiValue:function(e){var t={};return e.isDisabled||(t.onDelete=e.removeProps.onClick),i.a.createElement(St.a,Object.assign({tabIndex:-1,label:e.children,className:Object(ft.a)(e.selectProps.classes.chip,Object(w.a)({},e.selectProps.classes.chipFocused,e.isFocused)),deleteIcon:i.a.createElement(sa.a,e.removeProps)},t))},NoOptionsMessage:function(e){return i.a.createElement(ge.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return i.a.createElement(X.a,Object.assign({ref:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps,{className:"menu-item"}),e.children)},Placeholder:function(e){return i.a.createElement(ge.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return i.a.createElement(ge.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return i.a.createElement("div",{className:G()(e.selectProps.classes.valueContainer,e.selectProps.valueContainerClassName)},e.children)}};function ba(e){var t=fa(),a=Object(r.useState)(e.options||[]),n=Object(s.a)(a,2),o=n[0],l=n[1],u=Object(r.useState)(!1),d=Object(s.a)(u,2),m=d[0],f=d[1],p=i.a.useState(null),v=Object(s.a)(p,2),b=v[0],h=v[1],g=e.name,E=e.title,C=void 0===E?"":E,O=e.onChange,y=e.value,x=e.error,w=e.readOnly,N=void 0!==w&&w,S=e.isMulti,I=void 0!==S&&S,F=e.isSearchable,T=void 0!==F&&F,L=e.optionValueKey,P=void 0===L?"id":L,D=e.optionLabelKey,B=void 0===D?"title":D,M=e.fetchAPI,V=e.beforeFetchAPI,R=e.isPortal,z=e.inline,U=e.autoFocus,W=e.onFocus,A=e.InputProps,_=e.formControlStyle,H=e.clearIndicatorStyle,q=e.onView,K=Object(Nt.a)(e,["name","title","onChange","value","error","readOnly","isMulti","isSearchable","optionValueKey","optionLabelKey","fetchAPI","beforeFetchAPI","isPortal","inline","autoFocus","onFocus","InputProps","formControlStyle","clearIndicatorStyle","onView"]),Y=i.a.useCallback((function(t){return e.options.find((function(e){return e[P]===t}))}),[e.options,P]);function X(){return J.apply(this,arguments)}function J(){return(J=Object(k.a)(j.a.mark((function t(){var a,n,r=arguments;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.length>0&&void 0!==r[0]?r[0]:"",f(!0),!V){t.next=5;break}return t.next=5,V();case 5:if(!M){t.next=12;break}return t.next=8,M({search:a});case 8:n=t.sent,l(n),t.next=13;break;case 12:l(e.options);case 13:f(!1);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}i.a.useEffect((function(){if("object"!==typeof y){var e=y.split(",");h(1===e.length?Y(e[0].trim()):e.map((function(e){return Y(e.trim())})))}else h(y)}),[y,Y]);var Q=function(e,t){var a=i.a.useRef(null),n=function(){return a.current&&clearTimeout(a.current)},r=function(e){return a.current=setTimeout(e,t)};return i.a.useEffect((function(){return function(){return n()}}),[]),function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];n(),r((function(){return e.apply(void 0,a)}))}}(X,400);return N?i.a.createElement(Ht,{title:C,value:function(e){var t=o.find((function(t){return"object"===typeof e?"".concat(t[P])==="".concat(e[P]):"".concat(t[P||"value"])==="".concat(e)}));return t&&t[B]||("object"===typeof e&&e?e[B]:e)}(y)}):i.a.createElement(oa.a,{className:G()(t.formControl,{inline:z}),style:_},i.a.createElement(ma.a,Object.assign({autoFocus:U,name:g,InputProps:A,TextFieldProps:Object(c.a)({},z?{}:{label:C,InputLabelProps:{shrink:!0}},{error:x}),isLoading:m,onFocus:function(){W&&W(),X()},isClearable:!0,options:m?[]:o,onInputChange:function(e,t){"input-change"===t.action&&(f(!0),Q(e))},onChange:function(e){O("object"!==typeof y?I?e.map((function(e){return e[P]})).join(","):e&&e[P]:e)},value:b,placeholder:T?"Search ".concat(C):"Select ".concat(C),classes:t,components:va,isDisabled:N,isMulti:I,isSearchable:T,getOptionLabel:function(e){return e[B]},getOptionValue:function(e){return e[P]},blurInputOnSelect:!0,menuPlacement:"auto",styles:{menuPortal:function(e){return Object(c.a)({},e,{zIndex:1500})},container:function(e){return{width:"100%"}},clearIndicator:function(e){return Object(c.a)({},e,{},H)},menu:function(e){return Object(c.a)({},e,{marginTop:0,borderRadius:0})}}},K.options?{}:{filterOption:function(){return!0}},R?{menuPortalTarget:document.body}:{},K)),y&&q&&i.a.createElement("div",{onClick:function(e){e.stopPropagation(),q(y)},className:t.viewIcon},i.a.createElement(da.a,null)))}ba.defaultProps={isPortal:!0};var ha=ba,ga=a(188),Ea=a(395),Ca=a(363),Oa=a(382),ya=a(190),ja={date:Ea.a,time:Ca.a,datetime:Oa.a},ka={date:"DD/MM/YYYY",time:"LT",datetime:"DD/MM/YYYY h:mm a"};var xa=function(e){var t=e.inline,a=e.type,n=void 0===a?"date":a,o=Object(Nt.a)(e,["inline","type"]),l=Object(r.useState)(!1),u=Object(s.a)(l,2),d=u[0],m=u[1],f=i.a.useRef(),p=(o.name,o.title),v=o.format,b=o.readOnly,h=void 0!==b&&b,g=(o.error,o.onChange),E=Object(Nt.a)(o,["name","title","format","readOnly","error","onChange"]);if(h){var C=o.value?Fe()(o.value).format(v||ka[n]):"";return(i.a.createElement(Ht,{title:p,value:C}))}var O=ja[n];return i.a.createElement(ya.b,{utils:ga.a,moment:Fe.a},i.a.createElement(O,Object.assign({autoOk:!0,open:d,onChange:function(e){f.current=e},PopoverProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},disableToolbar:!0,variant:"inline"},t?{invalidDateMessage:""}:{},{style:Object(c.a)({width:"100%"},t?{margin:0}:{}),label:t?"":p,format:v||ka[n]},"time"!==n?{animateYearScrolling:!1}:{},E,{onKeyDown:function(e){40===e.keyCode&&m(!0)},onClose:function(){g(f.current),m(!1)},onOpen:function(){return m(!0)}})))},wa=a(191);function Na(e){var t=e.inputRef,a=(e.onChange,e.thousandSeparator),n=void 0===a||a,r=Object(Nt.a)(e,["inputRef","onChange","thousandSeparator"]);return(i.a.createElement(wa.a,Object.assign({getInputRef:t,thousandSeparator:n},r)))}function Sa(e){var t=e.type,a=void 0===t?"integer":t,n=e.title,o=e.onChange,l=e.value,c=void 0===l?0:l,u=e.readOnly,d=e.scale,m=void 0===d?2:d,f=e.customeFormat,p=e.onBlur,v=Object(Nt.a)(e,["type","title","onChange","value","readOnly","scale","customeFormat","onBlur"]),b=Object(r.useState)(c),h=Object(s.a)(b,2),g=h[0],E=h[1],C=Object(r.useCallback)((function(e){return Number(Number(e).toFixed("integer"===a?0:m))}),[a,m]);return i.a.useEffect((function(){E(C(c))}),[c,E,C]),u?i.a.createElement(Ht,{title:n,value:i.a.createElement(Na,Object.assign({},f,{value:c,displayType:"text"})),customRender:!0}):i.a.createElement(Kt,Object.assign({onChange:E,title:n,type:"number",value:"".concat(g),onBlur:function(e){o(C(g)),E(C(g)),p&&p(e)}},v))}Sa.defaultProps={readOnly:!1};var Ia=Sa,Fa={enum:["=","!=","isNull","notNull"],text:["like","notLike","isNull","notNull"],string:["=","!=","like","notLike","isNull","notNull"],integer:["=","!=",">=","<=",">","<","between","notBetween","isNull","notNull"],boolean:["isTrue","isFalse"]},Ta=[{name:"=",title:ue("equals")},{name:"!=",title:ue("not equal")},{name:">",title:ue("greater than")},{name:">=",title:ue("greater or equal")},{name:"<",title:ue("less than")},{name:"<=",title:ue("less or equal")},{name:"in",title:ue("in")},{name:"between",title:ue("between")},{name:"notBetween",title:ue("not Between")},{name:"notIn",title:ue("not in")},{name:"isNull",title:ue("is null")},{name:"notNull",title:ue("is not null")},{name:"like",title:ue("contains")},{name:"notLike",title:ue("doesn't contain")},{name:"isTrue",title:ue("true")},{name:"isFalse",title:ue("false")}];function La(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[{name:e.targetName}];e.targetSearch&&(n=e.targetSearch.map((function(e){return{name:e}})));var r=new R({model:e.target});return r.search(Object(c.a)({},a,{limit:10,offset:0,fields:n.map((function(e){return e.name})),data:t?n.reduce((function(e,a){return Object(c.a)({},e,Object(w.a)({},a.name,t))}),{criteria:void 0,operator:void 0}):{}}))}var Pa=Object(N.a)((function(e){return{group:{margin:"0px 8px",flexDirection:"row"},button:{margin:e.spacing(1)},label:{fontSize:"0.875rem"},list:{width:"100%",padding:0},listItem:{paddingLeft:0,paddingTop:0,paddingBottom:0},link:{margin:e.spacing(1)},textField:{margin:e.spacing(1),flexBasis:200},divider:{width:1,height:28,margin:4},criteriaValue:{width:"250px !important",alignItems:"normal"},mobileViewCriteria:{flexWrap:"wrap"},mobileViewButtonLink:{display:"flex",justifyContent:"center"}}})),Da={title:"",operator:"and",isArchived:!1,isShare:!1,criteria:[{}],selected:!1},Ba=function(e,t){e.map((function(e){return Fa[e]=t}))};function Ma(e,t,a){var n=a.onChange,r=a.value,o=a.value2,l=a.classes,s=a.style,u=Object(Nt.a)(a,["onChange","value","value2","classes","style"]);return["=","!=",">",">=","<","<=","like","notLike"].includes(t)?i.a.createElement(e,Object.assign({name:"value",className:l.criteriaValue,onChange:function(e){return n({name:"value",value:e})},value:r},u)):["between","notBetween"].includes(t)?i.a.createElement(i.a.Fragment,null,i.a.createElement(e,Object.assign({name:"value",style:Object(c.a)({marginRight:8},s),className:l.criteriaValue,onChange:function(e){return n({name:"value",value:"".concat(e)})},value:r},u)),i.a.createElement(e,Object.assign({name:"value2",className:l.criteriaValue,onChange:function(e){return n({name:"value2",value:"".concat(e)})},value:o},u))):void 0}function Va(e){var t=e.type,a=e.operator,n=e.onChange,r=e.value,o=e.classes,l=Object(Nt.a)(e,["type","operator","onChange","value","classes"]),s=Object(c.a)({value:r.value,value2:r.value2,onChange:n},l);switch(t){case"one_to_one":case"many_to_one":case"many_to_many":case"one_to_many":return function(e,t){var a=t.onChange,n=Object(Nt.a)(t,["onChange"]);if(["like","notLike","notIn"].includes(e))return i.a.createElement(Kt,Object.assign({name:"value",onChange:function(e){return a({name:"value",value:e})},margin:"none",style:{width:250}},n));if(["in"].includes(e)){var r=n.field,o=n.value,l=r.targetName,c=function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.search,e.next=3,La(r,a);case 3:return n=e.sent,i=n.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(ha,{placeholder:"",fetchAPI:c,isSearchable:!0,optionLabelKey:l,optionValueKey:"id",name:"value",value:o,isMulti:!0,formControlStyle:{marginBottom:"5px",width:250},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1,onChange:function(e){return a({name:"value",value:Array.isArray(e)?e.map((function(e){return Object(w.a)({id:e.id},l,e[l])})):e&&Object(w.a)({id:e.id},l,e[l])})}})}}(a,Object(c.a)({},s));case"date":case"time":case"dateTime":return Ma(xa,a,Object(c.a)({type:t},s,{format:"DD/MM/YYYY",margin:"none",classes:o}));case"integer":case"long":case"decimal":return Ma(Ia,a,Object(c.a)({type:t},s,{margin:"none",classes:o}));case"enum":var u=l.field.selectionList.map((function(e){var t=e.title,a=e.value,n=e.data;return{name:n&&n.value||a,title:t}}));return Ma(ia,a,Object(c.a)({options:u,classes:o},s));default:return Ma(Kt,a,Object(c.a)({classes:o},s,{margin:"none"}))}}function Ra(e){var t=e.className,a=e.onRemove,n=e.onChange,r=e.value,o=e.fields,l=e.classes,s=e.mobileView,u=o.find((function(e){return e.name===r.fieldName})),d=(u&&u.type||"").toLowerCase();u&&u.selectionList&&(d="enum");var m=Ta.filter((function(e){return(Fa[d]||[]).includes(e.name)}));function f(e){var t=e.name,a=e.options,o=Object(Nt.a)(e,["name","options"]);return(i.a.createElement(ia,Object.assign({name:t,onChange:function(e){return n({name:t,value:e})},value:r[t],options:a},o)))}return(i.a.createElement("div",null,i.a.createElement(st.a,{"aria-label":"close",className:t,onClick:a},i.a.createElement(wt.a,null)),i.a.createElement("div",{className:G()(Object(w.a)({},l.mobileViewCriteria,s))},i.a.createElement(f,{name:"fieldName",options:o,className:"fieldName"}),i.a.createElement(f,{name:"operator",options:m,className:"operator"}),r.operator&&Va(Object(c.a)({type:d,operator:r.operator,value:r,onChange:n,classes:l},{field:u})))))}function za(e){var t=e.customCriteria,a=e.setCustomCriteria,n=e.fields,r=e.clearFilters,o=e.applyFiltersClick,l=e.filterView,u=e.onSave,d=e.onDelete,m=e.mobileView,f=e.onExport,p=e.onExportAll,v=Pa(),b=i.a.useState(!1),h=Object(s.a)(b,2),g=h[0],E=h[1],C=t.id,O=t.operator,y=t.isArchived,j=t.criteria,k=t.title,x=t.isShare;function N(e){var n=e.target,r=n.name,i=n.value;a(Object(c.a)({},t,Object(w.a)({},r,i)))}function S(e,t,r){t instanceof Fe.a&&(t=Fe()(t).format("YYYY-MM-DD")),a(Object(Yt.a)((function(a){a.criteria[r][e]=t,"fieldName"===e&&(a.criteria[r].operator="",a.criteria[r].value=function(e){var t=n.find((function(t){return t.name===e})).type.toLowerCase();return["one_to_one","many_to_one","many_to_many","one_to_many"].includes(t)?null:["integer","long","decimal"].includes(t)?0:["date","time","dateTime"].includes(t)?null:""}(t))})))}function I(){var e=t.id,a=t.version,n=t.title,r=t.isShare,i=t.operator,o=t.criteria,c={shared:r||!1,title:n,filterCustom:JSON.stringify({operator:i,criteria:o}),filterView:l};e?(c.id=e,c.version=a):c.name=n.replace(" ","_").toLowerCase(),u(c)}return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement(ea,{name:"operator",onChange:function(e){return N(e)},value:O,classes:v,className:v.group,data:[{label:ue("and"),value:"and"},{label:ue("or"),value:"or"}]}),i.a.createElement(ta,{name:"isArchived",title:ue("Show archived"),value:y,onChange:function(e){var t=e.name;return N({target:{value:e.checked,name:t}})},classes:v,className:"archived"})),i.a.createElement("div",null,i.a.createElement(dt.a,{className:v.list},j.map((function(e,t){return i.a.createElement(mt.a,{className:v.listItem,key:t},i.a.createElement(Ra,{className:v.buttonLink,id:t,value:e,fields:n,onRemove:function(){return function(e){a(Object(Yt.a)((function(t){1===t.criteria.length?t.criteria=[{}]:t.criteria.splice(e,1)})))}(t)},onChange:function(e){return S(e.name,e.value,t)},classes:v,mobileView:m}))})))),i.a.createElement("div",{className:G()(v.buttonLink,Object(w.a)({},v.mobileViewButtonLink,m))},i.a.createElement(Zt,{title:ue("Add filter"),className:G()(v.link,"add-filter"),onClick:function(){a(Object(Yt.a)((function(e){e.criteria[e.criteria.length-1].operator&&e.criteria.push({})})))}}),i.a.createElement(jt.a,{className:v.divider}),i.a.createElement(Zt,{title:ue("Clear"),className:G()(v.link,"clear"),onClick:function(){r(),a(Da)}}),i.a.createElement(jt.a,{className:v.divider}),i.a.createElement(Zt,{title:ue("Export"),className:v.link,onClick:f}),i.a.createElement(jt.a,{className:v.divider}),i.a.createElement(Zt,{title:ue("Export full"),className:v.link,onClick:p}),i.a.createElement(jt.a,{className:v.divider}),i.a.createElement(Zt,{title:ue("Apply"),className:G()(v.link,"apply-filter"),onClick:function(){return o(t)}})),i.a.createElement(jt.a,{style:{marginTop:8}}),i.a.createElement("div",null,i.a.createElement(Kt,{name:"title",value:k,onChange:function(e){return N({target:{value:e,name:"title"}})},className:G()(v.textField,"title")}),i.a.createElement(ta,{title:ue("share"),name:"isShare",value:x,onChange:function(e){var t=e.name;return N({target:{value:e.checked,name:t}})},className:"share"})),i.a.createElement("div",null,i.a.createElement(aa,{classes:v,onClick:I,title:ue("Save"),hide:""===k||null===k||void 0!==C,className:"save"}),i.a.createElement(aa,{classes:v,onClick:I,title:ue("Update"),hide:""===C||void 0===C||null===C}),i.a.createElement(aa,{classes:v,onClick:function(){return E(!0)},title:ue("Delete"),hide:""===C||void 0===C||null===C,className:"delete"}),i.a.createElement(Q.a,{open:g,onClose:function(){return E(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},i.a.createElement($.a,{id:"alert-dialog-title"},"Question"),i.a.createElement(Z.a,null,i.a.createElement(Gt.a,{id:"alert-dialog-description"},ue("Would you like to remove the filter?"))),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:function(){return E(!1)},className:"cancel"},ue("Cancel")),i.a.createElement(te.a,{onClick:function(){d(t),E(!1)},color:"primary",autoFocus:!0,className:"confirm-delete"},ue("Ok"))))))}Ba(["long","decimal","date","time","datetime"],Fa.integer),Ba(["one_to_many"],Fa.text),Ba(["one_to_one","many_to_one","many_to_many"],["like","notLike","in","notIn","isNull"]);var Ua=Object(N.a)((function(e){return{container:{border:"1px solid",borderRadius:20,backgroundColor:e.palette.grey[200],borderColor:e.palette.grey[300],padding:"0 ".concat(e.spacing(),"px"),width:"100%",maxWidth:300,"& > div:last-child":{zIndex:1}},textField:{margin:e.spacing(1),flexBasis:200},divider:{width:1,height:28,margin:4},typography:{padding:e.spacing(1),fontWeight:600,flex:1},searchContainer:{display:"flex",flexDirection:"column","& div":{display:"flex",alignItems:"center"}},formControl:{margin:e.spacing(1)},group:{margin:"0px 8px",flexDirection:"row"},paper:{minWidth:480,boxShadow:"0 4px 12px rgb(0,0,0,0.4)"},link:{margin:e.spacing(1)},button:{margin:e.spacing(1)},list:{width:"100%",padding:0},listItem:{paddingLeft:0,paddingTop:0,paddingBottom:0},searchFilterContainer:{display:"flex",alignItems:"flex-start !important"},searchFilter:{flexDirection:"column",alignItems:"baseline !important",width:"100%"},filter:{flexDirection:"column",marginLeft:8,alignItems:"baseline !important"},inputIconBtn:{margin:0,padding:0,color:"#bbb"},label:{fontSize:"0.875rem"},filterLabel:{display:"flex",alignItems:"center",margin:"0 8px"}}}));function Wa(e){try{return JSON.parse(e)}catch(t){return e}}function Aa(e){var t=e.icon,a=e.title,n=e.classes;return(i.a.createElement("div",{className:n.filterLabel},i.a.createElement(Mt,{icon:t}),i.a.createElement(ge.a,{className:n.typography},a)))}function _a(e){var t=e.filter,a=e.disabled,n=e.isChecked,r=e.onClick,o=e.onChange,l=e.classes,c=t.title;return i.a.createElement(mt.a,{className:l.listItem},i.a.createElement(ta,{name:c.replace(" ","_").toLowerCase(),value:n,onChange:function(e){o(e,t)},inline:!0,isDisabled:a}),i.a.createElement(Zt,{title:c,onClick:function(){return(!a||n)&&r(t,!n)},style:a&&!n?{color:"rgba(0, 0, 0, 0.54)"}:{}}))}function Ha(e){var t=e.active,a=void 0===t?[]:t,n=e.data,r=void 0===n?[]:n,o=e.disabled,l=e.onClick,c=e.onChange,s=e.classes;return(i.a.createElement("div",{className:s.filter},i.a.createElement(dt.a,{className:s.list},r.map((function(e){return i.a.createElement(_a,{key:e.id,filter:e,isChecked:a.includes(e.id),disabled:o,onClick:l,onChange:c,classes:s})})))))}function qa(e){var t=e.filters,a=e.value,n=void 0===a?[]:a,o=e.onOpen,l=e.onDelete,c=e.classes,u=e.onContentSearch,d=Object(r.useState)(""),m=Object(s.a)(d,2),f=m[0],p=m[1],v=i.a.useCallback((function(e){var t=e.target.value;u(t||f)}),[u,f]);return n.length>0?i.a.createElement(Ft,{handleClick:o,value:n,onDelete:l,filters:t}):i.a.createElement(Kt,{name:"search",margin:"none",onChange:p,onKeyPress:function(e){return"Enter"===e.key&&v(e)},value:f,InputProps:{disableUnderline:!0,endAdornment:i.a.createElement(yt.a,{position:"end"},i.a.createElement(st.a,{"aria-label":"open",onClick:o,className:c.inputIconBtn},i.a.createElement(pt.a,null)),i.a.createElement(st.a,{"aria-label":"refresh",className:c.inputIconBtn,onClick:v},i.a.createElement(xt.a,null)))}})}function Ka(e){var t=e.name,a=e.value,n=e.fields,o=e.filters,l=void 0===o?[]:o,u=e.domain,d=void 0===u?[]:u,m=e.onSave,f=e.onDelete,p=e.handleChange,v=e.onContentSearch,b=e.onExport,h=e.onExportAll,g=Ua(),E=Object(r.useRef)(),C=i.a.useState(!1),O=Object(s.a)(C,2),y=O[0],w=O[1],N=i.a.useState([]),S=Object(s.a)(N,2),I=S[0],F=S[1],T=i.a.useState(!1),L=Object(s.a)(T,2),P=L[0],D=L[1],B=Object(r.useState)(Da),M=Object(s.a)(B,2),V=M[0],R=M[1],z=P?l.find((function(e){return e.id===I[0]})):null;function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=l.filter((function(t){return e.includes(t.id)})),r=d.filter((function(t){return e.includes(t.id)})),i={criteria:[],operator:t.operator||"and"};if(a&&P)i.criteria=t.criteria;else{var o,c;if(n.length)(c=i.criteria).push.apply(c,Object(x.a)(n.map((function(e){var t=Wa(e.filterCustom),a=t.criteria,n=void 0===a?[]:a;return{operator:t.operator,criteria:n}}))));(o=i.criteria).push.apply(o,Object(x.a)(t.criteria||[]))}return r.length&&(i._domains=r.map((function(e){return{title:e.title,domain:e.domain}}))),i}function W(e,t){var a=[];e.length>0&&(a=U(e,t)),p({selected:Object(x.a)(e),query:a})}function A(e,t){var a=!!e.domain,n=t&&e?[e.id]:[];D(!a&&t),F(n),W(n)}function _(e,t){var a=t.id,n=I.findIndex((function(e){return e===a}));n>-1?!e&&I.splice(n,1):e&&I.push(a),F(Object(x.a)(I))}function H(){p({}),F([]),D(!1),R(Da)}function q(e){I.length>0?W(I.length?Object(x.a)(I):[null]):e&&e.criteria.length&&function(e){p({selected:[null],query:U(I,e,!0)})}(Object(c.a)({},e,{criteria:(e.criteria||[]).filter((function(e){return e.fieldName&&e.operator}))})),w(!1)}var K=function(e){f(e),H()},G=function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t);case 2:A(e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){return w(!1)},X=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(i.a.createElement("div",{className:g.searchContainer},i.a.createElement("div",null,i.a.createElement(ge.a,{className:g.typography},ue("Advanced Search")),i.a.createElement(st.a,{"aria-label":"close",onClick:Y},i.a.createElement(wt.a,null))),i.a.createElement(jt.a,null),i.a.createElement("div",{className:g.searchFilterContainer},d.length>0&&i.a.createElement("div",{className:g.searchFilter},i.a.createElement(Aa,{icon:"filter",title:"Filters",classes:g}),i.a.createElement(Ha,{data:d,disabled:P,active:I,onClick:A,onChange:_,classes:g})),l.length>0&&i.a.createElement("div",{className:g.searchFilter},i.a.createElement(Aa,{icon:"filter",title:"My Filter",classes:g}),i.a.createElement(Ha,{data:l,disabled:P,active:I,onClick:A,onChange:_,classes:g}))),l.length>=1||d.length?i.a.createElement(jt.a,{style:{marginTop:8}}):"",i.a.createElement(za,{fields:n,clearFilters:H,applyFiltersClick:q,filterView:t,onSave:G,onDelete:K,customCriteria:V,setCustomCriteria:R,mobileView:e,onExport:b,onExportAll:h})))};return Object(r.useEffect)((function(){if(z){var e=Wa(z.filterCustom),t=e.criteria,a=e.operator;R(Object(c.a)({},z,{operator:a,criteria:t.map((function(e){return Object(c.a)({},e,{operator:e.operator})}))}))}else R(Da)}),[R,z]),i.a.createElement("div",{className:g.container,ref:E},i.a.createElement(qa,{value:a&&a.selected,filters:l,onOpen:function(){return w((function(e){return!e}))},onDelete:H,classes:g,onContentSearch:v}),i.a.createElement(Ze,{DesktopView:function(){return i.a.createElement(lt.a,{onClickAway:Y},i.a.createElement(kt.a,{open:y,anchorEl:E.current,placement:"bottom-end",disablePortal:!0},i.a.createElement(Xe.a,{className:g.paper},X())))},MobileView:function(){return i.a.createElement(ut.a,{open:y,fullScreen:!0},X(!0))}}))}var Ga=Object(N.a)((function(e){return{toolbarWrapper:{flexGrow:1,position:"relative",backgroundColor:"white",padding:"5px 10px",display:"flex"},iconButton:{marginLeft:e.spacing(),padding:e.spacing(.5)},icon:{backgroundColor:"transparent",color:e.palette.grey[600],transition:e.transitions.create(["color"],{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.standard})},selectedViewMode:{color:e.palette.grey[900],borderRadius:"50%"},popper:{zIndex:9999},customButton:{width:"100%",borderRadius:4,cursor:"pointer",display:"flex",border:"1px solid",justifyContent:"space-between",alignItems:"center",padding:e.spacing(.5),borderColor:e.palette.grey[300],transition:e.transitions.create(["background-color"],{easing:e.transitions.easing.easeInOut}),"&:hover":{backgroundColor:e.palette.grey[200]}},projectSelectorPaper:Object(w.a)({width:280},e.breakpoints.only("xs"),{width:"100%"}),favourite:{marginLeft:e.spacing()},favouriteButtonText:{marginLeft:e.spacing(),textTransform:"capitalize"},favouriteButton:{justifyContent:"center"},favouriteIcon:{color:ze.a[500]},mobileDrawer:{padding:e.spacing()},desktopToolbarWrapper:{display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between"},projectSelector:{flex:1,minWidth:290,maxWidth:290,display:"flex"},advanceSearch:{flex:1,display:"flex",justifyContent:"flex-end",marginLeft:e.spacing()},actionIcon:{fontSize:20,marginRight:10},uploadText:{textTransform:"capitalize"}}}));function Ya(e){var t=e.total;return e.offset+e.limit>=t}function Xa(e){return 0===e.offset}function Ja(e){var t=e.selectedProject,a=e.projectList,n=e.handleSelectedProject,r=Ga(),o=i.a.useState(null),l=Object(s.a)(o,2),c=l[0],u=l[1],d=function(){u(null)};var m=Boolean(c),f=t?t.fullName:ue("Select Project");return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{onClick:function(e){u(e.currentTarget)},className:r.customButton},i.a.createElement(ge.a,{noWrap:!0,variant:"body1",title:f},f),i.a.createElement(pt.a,null)),i.a.createElement(ot.a,{open:m,anchorEl:c,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"},classes:{paper:r.projectSelectorPaper}},i.a.createElement(Xe.a,null,i.a.createElement(lt.a,{onClickAway:d},i.a.createElement(ct.a,{autoFocus:m,id:"menu-list-grow",onKeyDown:function(e){"Tab"===e.key&&(e.preventDefault(),d())}},a.map((function(e){return i.a.createElement(X.a,{onClick:function(t){return function(e,t){e.preventDefault(),n(t),d()}(t,e)},key:e.id},i.a.createElement(ge.a,{noWrap:!0,variant:"body1"},e.fullName))})))))))}var Qa=function(e){var t=e.onListViewClick,a=e.onGridViewClick,n=e.viewMode,r=e.fields,o=e.onSave,l=e.onRemove,c=e.filters,s=e.onFilter,u=e.searchFilter,d=e.handleSelectedProject,m=e.selectedProject,f=e.projectList,p=e.pagination,v=e.onPrev,b=e.onNext,h=e.onFavouriteSearch,g=e.onContentSearch,E=e.FavouriteIcon,C=e.onExport,O=e.onExportAll,y=Ga();return i.a.createElement("div",{className:y.desktopToolbarWrapper},i.a.createElement("div",{className:y.projectSelector},i.a.createElement(Ja,{selectedProject:m,projectList:f,handleSelectedProject:d})),i.a.createElement("div",{className:y.favourite},i.a.createElement("div",{className:Object(ft.a)(y.customButton,y.favouriteButton),onClick:h},i.a.createElement(E,{className:y.favouriteIcon}),i.a.createElement(ge.a,{className:y.favouriteButtonText,noWrap:!0},ue("Favourites")))),i.a.createElement("div",{className:y.advanceSearch},i.a.createElement(Ka,{fields:r,handleChange:s,onSave:o,onDelete:l,filters:c,value:u,onContentSearch:g,onExport:C,onExportAll:O})),i.a.createElement("div",null,i.a.createElement(st.a,{size:"small",onClick:v,className:y.iconButton,disabled:Xa(p)},i.a.createElement(vt.a,{className:y.icon})),i.a.createElement(st.a,{size:"small",onClick:b,className:y.iconButton,disabled:Ya(p)},i.a.createElement(bt.a,{className:y.icon})),i.a.createElement(st.a,{size:"small",onClick:t,className:y.iconButton},i.a.createElement(ht.a,{className:Object(ft.a)(y.icon,Object(w.a)({},y.selectedViewMode,"list"===n))})),i.a.createElement(st.a,{size:"small",onClick:a,className:y.iconButton},i.a.createElement(gt.a,{className:Object(ft.a)(y.icon,Object(w.a)({},y.selectedViewMode,"card"===n))}))))},$a=function(e){var t=e.onListViewClick,a=e.onGridViewClick,n=e.viewMode,o=e.fields,l=e.onSave,c=e.onRemove,u=e.filters,d=e.onFilter,m=e.searchFilter,f=e.handleSelectedProject,p=e.selectedProject,v=e.projectList,b=e.pagination,h=e.onPrev,g=e.onNext,E=e.onFavouriteSearch,C=e.onContentSearch,O=e.FavouriteIcon,y=e.onOpenUpload,j=e.onExport,k=e.onExportAll,x=Ga(),N=Object(r.useState)(!1),S=Object(s.a)(N,2),I=S[0],F=S[1],T=function(){return F(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(st.a,{size:"small",onClick:function(){return F(!0)},className:x.iconButton,style:{margin:0}},i.a.createElement(Et.a,{className:x.icon})),i.a.createElement(st.a,{size:"small",onClick:E,className:x.iconButton},i.a.createElement(O,{className:Object(ft.a)(x.icon,x.favouriteIcon)})),i.a.createElement("div",{className:x.advanceSearch},i.a.createElement(Ka,{fields:o,handleChange:d,onSave:l,onDelete:c,filters:u,value:m,onContentSearch:C,onExport:j,onExportAll:k})),i.a.createElement(st.a,{size:"small",onClick:h,className:x.iconButton,disabled:Xa(b)},i.a.createElement(vt.a,{className:x.icon})),i.a.createElement(st.a,{size:"small",onClick:g,className:x.iconButton,disabled:Ya(b)},i.a.createElement(bt.a,{className:x.icon})),i.a.createElement(st.a,{size:"small",onClick:t,className:x.iconButton},i.a.createElement(ht.a,{className:Object(ft.a)(x.icon,Object(w.a)({},x.selectedViewMode,"list"===n))})),i.a.createElement(st.a,{size:"small",onClick:a,className:x.iconButton},i.a.createElement(gt.a,{className:Object(ft.a)(x.icon,Object(w.a)({},x.selectedViewMode,"card"===n))})),i.a.createElement(ut.a,{anchor:"top",open:I,onClose:T},i.a.createElement(dt.a,null,i.a.createElement(mt.a,{button:!0},i.a.createElement(Ja,{selectedProject:p,projectList:v,handleSelectedProject:function(e){T(),f(e)}})),p&&i.a.createElement(mt.a,{button:!0},i.a.createElement(te.a,{fullWidth:!0,variant:"outlined",onClick:function(){T(),y()}},i.a.createElement("i",{className:G()("fa fa-upload",x.actionIcon)}),i.a.createElement(ge.a,{className:x.uploadText},ue("Upload Files")))))))},Za=function(e){var t=e.onViewModeChange,a=e.viewMode,n=e.fields,o=e.onSave,l=e.onRemove,c=e.filters,s=e.onFilter,u=e.searchFilter,d=e.handleSelectedProject,m=e.selectedProject,f=e.projectList,p=e.pagination,v=e.onPrev,b=e.onNext,h=e.favouriteSearch,g=e.onFavouriteSearch,E=e.onContentSearch,C=e.onOpenUpload,O=e.onExport,y=e.onExportAll,j=Ga(),k={onListViewClick:Object(r.useCallback)((function(){t("list")}),[t]),onGridViewClick:Object(r.useCallback)((function(){t("card")}),[t]),viewMode:a,fields:n,onSave:o,onRemove:l,filters:c,onFilter:s,searchFilter:u,handleSelectedProject:d,selectedProject:m,projectList:f,pagination:p,onPrev:v,onNext:b,onFavouriteSearch:g,onContentSearch:E,FavouriteIcon:h?Ct.a:Ot.a,onOpenUpload:C,onExport:O,onExportAll:y};return Object(r.useEffect)((function(){f&&1===f.length&&d(f[0])}),[f,d]),i.a.createElement(Xe.a,{elevation:4,square:!0,className:j.toolbarWrapper},i.a.createElement(Ze,{DesktopView:Qa,MobileView:$a,viewProps:k}))},en=a(392),tn=a(145),an=a.n(tn),nn=a(193),rn=a.n(nn),on=a(289),ln=a(134),cn=a.n(ln),sn=a(108);sn.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(sn.pdfjs.version,"/pdf.worker.js");var un=Object(z.a)((function(e){return{form:{display:"flex",flexDirection:"column"},pdfPage:{display:"flex",justifyContent:"center"},mobilePdfPage:{"&>div":{width:"100% !important"},"& > canvas":{width:"100% !important"}},pdfNavigation:{display:"flex"},mobileImage:{width:"fit-content"},mobielForm:{overflowX:"hidden"},imageView:{overflowX:"auto"}}})),dn=new B;var mn=function(e){var t=un(),a=Object(on.a)(),n=e.document,r=e.onClose,o=e.open,l=i.a.useState(),c=Object(s.a)(l,2),u=c[0],d=c[1],m=i.a.useState(1),f=Object(s.a)(m,2),p=f[0],v=f[1],b=i.a.useState(),h=Object(s.a)(b,2),g=h[0],E=h[1],C=Object(Rt.a)(a.breakpoints.up("sm")),O=i.a.useCallback((function(e){var t=e.numPages;d(t)}),[]),y=i.a.useCallback((function(){v((function(e){return e+1}))}),[]),j=i.a.useCallback((function(){v((function(e){return e-1}))}),[]);return i.a.useEffect((function(){n.fileType&&-1!==n.fileType.indexOf("pdf")&&dn.download(n,!0).then((function(e){E(e)}))}),[n]),i.a.createElement(Q.a,{onClose:r,"aria-labelledby":"simple-dialog-title",open:o,maxWidth:"lg",fullWidth:!0,fullScreen:!C,TransitionComponent:tt,transitionDuration:200},i.a.createElement($.a,null,ue("File preview")),i.a.createElement(Z.a,{className:G()(t.form,Object(w.a)({},t.mobielForm,!C))},-1!==n.fileType.indexOf("sheet")?i.a.createElement(cn.a,{fileType:"xlsx",filePath:se(n.id)}):-1!==n.fileType.indexOf("csv")?i.a.createElement(cn.a,{fileType:"csv",filePath:se(n.id)}):-1!==n.fileType.indexOf("document")?i.a.createElement(cn.a,{fileType:"docx",filePath:se(n.id)}):-1!==n.fileType.indexOf("pdf")&&g?i.a.createElement("div",null,i.a.createElement(sn.Document,{file:g,onLoadSuccess:O},i.a.createElement(sn.Page,{className:G()(t.pdfPage,Object(w.a)({},t.mobilePdfPage,!C)),pageNumber:p}))):-1!==n.fileType.indexOf("image")?i.a.createElement("div",{className:t.imageView},i.a.createElement("img",{src:ce(n.id),alt:n.fileName,className:G()(Object(w.a)({},t.mobileImage,!C))})):i.a.createElement(ge.a,null,ue("File format not supported yet"))),i.a.createElement(ee.a,null,-1!==n.fileType.indexOf("pdf")&&g&&i.a.createElement("div",{className:t.pdfNavigation},i.a.createElement(st.a,{disabled:p<=1,onClick:j},i.a.createElement(vt.a,null)),i.a.createElement("p",null,ue("Page")," ",p," of ",u),i.a.createElement(st.a,{disabled:p>=u,onClick:y},i.a.createElement(bt.a,null))),i.a.createElement(te.a,{onClick:r,variant:"outlined"},ue("Close"))))},fn=Object(N.a)((function(e){return{paper:{width:"inherit",overflow:"hidden"},drawer:{width:350},fullDrawer:{width:"100%"},header:{padding:10,boxShadow:e.shadows[4]},actionIcon:{border:"1px solid rgba(0,0,0,0.5)",fontSize:25,padding:10,margin:5,width:50,textAlign:"center",cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, .05)"}},content:{padding:10},thumbnail:{display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #0003",borderRadius:4,width:"97%",alignSelf:"center",marginBottom:10,cursor:"pointer",position:"relative",height:200},thumbnailImage:{maxHeight:"100%",maxWidth:"100%"},thumbnailTypeIcon:{fontSize:150},documentLockIcon:{position:"absolute",fontSize:25,right:10,top:5},versionListItem:{borderBottom:"1px solid rgba(0,0,0,0.2)",padding:"5px 0px",display:"flex",flexWrap:"wrap"},versionFileName:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},restoreButton:{padding:"0px !important",marginLeft:3,textTransform:"capitalize !important"},versionDownloadIcon:{marginTop:7,paddingLeft:5,cursor:"pointer"},formControl:{margin:e.spacing(1),width:"90%"},chips:{display:"flex",flexWrap:"wrap"},chip:{marginRight:5,marginTop:5},chipContent:{display:"flex",flexDirection:"row"},chipClose:{width:"0.9em",paddingLeft:5,cursor:"pointer"},tagSaveIcon:{marginTop:30,cursor:"pointer",color:"rgb(47, 160, 66)"},restoreText:{fontSize:"0.8rem !important"},getVersionButton:{textTransform:"capitalize !important",margin:"10px 0px 10px 5px"},"@keyframes rotateKF":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(359deg)"}},syncIcon:{animation:"$rotateKF 1s infinite linear reverse"}}}));function pn(e){var t=e.item,a=e.onClick,n=fn(),r=t.fileName,o=t.fileType;return t.id?i.a.createElement("div",{className:n.thumbnail,onClick:a},o&&-1!==o.indexOf("image")?i.a.createElement("img",{src:"".concat(ce(t.id),"?v=").concat(t.version),alt:r,className:n.thumbnailImage}):i.a.createElement("i",{className:G()(t.typeIcon,n.thumbnailTypeIcon,n.thumbnailImage)}),t.isLock&&i.a.createElement("i",{title:"Lock",className:G()("fa fa-lock",n.documentLockIcon)})):null}var vn=new R({model:"com.axelor.apps.projectdms.db.DMSVersion"}),bn={PaperProps:{style:{maxHeight:224,width:250}}},hn=function(e){var t=e.document,a=e.onClose,n=e.onDownload,o=e.onNewVersion,l=e.onLock,u=e.onSendMail,d=e.onUnlock,m=e.userId,f=e.onRestore,p=e.onVersionDownload,v=e.tagList,b=e.onTagSave,h=e.onPermission,g=fn(),E=Object(Ut.a)(),C=Object(r.useState)([]),O=Object(s.a)(C,2),y=O[0],j=O[1],k=Object(r.useState)([]),N=Object(s.a)(k,2),S=N[0],I=N[1],F=Object(r.useState)(!1),T=Object(s.a)(F,2),L=T[0],P=T[1],D=Object(r.useState)(!1),B=Object(s.a)(D,2),M=B[0],V=B[1],R=Object(Rt.a)(E.breakpoints.up("sm")),z=i.a.useCallback((function(){t.fileType&&P(!0)}),[t]),U=Object(r.useCallback)((function(){if(t){V(!0);var e={_domain:"self.documentId.id = ".concat(t.id)};vn.search({fields:["metaFile","documentVersion"],data:e}).then((function(e){var t=e.data,a=void 0===t?[]:t;j(Object(x.a)(a)),setTimeout((function(){return V(!1)}),1e3)})).catch((function(){return setTimeout((function(){return V(!1)}),1e3)}))}}),[t]),W=Object(r.useCallback)((function(e){var a=e.target.value;I((function(e){if(!e.find((function(e){return e.id===a.id}))){var n=[].concat(Object(x.a)(e),[a]);return t&&b(n),n}return e}))}),[t,b]),A=Object(r.useCallback)((function(e,t){e.stopPropagation(),I((function(e){var a=e.filter((function(e){return e.id!==t.id}));return b(a),a}))}),[b]),_=Object(r.useCallback)((function(){return P(!1)}),[]);return Object(r.useEffect)((function(){if(j([]),U(),t){var e=t.tags;e&&I(Object(x.a)(e))}}),[t,U]),i.a.createElement(ut.a,{className:G()(Object(w.a)({},g.drawer,R),Object(w.a)({},g.fullDrawer,!R)),open:Boolean(t),onClose:a,anchor:"right",variant:"persistent",classes:{paper:g.paper}},t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ce.a,{container:!0,justify:"space-between",className:g.header},i.a.createElement(Ce.a,{item:!0,xs:10},i.a.createElement(ge.a,{noWrap:!0,variant:"body1"},t.fileName)),i.a.createElement(Ce.a,{item:!0,xs:2,align:"right"},i.a.createElement(st.a,{size:"small",onClick:a},i.a.createElement(an.a,{fontSize:"small"})))),i.a.createElement(Ce.a,{container:!0,direction:"column",className:g.content},i.a.createElement(pn,{item:t,onClick:z}),i.a.createElement(Ce.a,{item:!0,container:!0,justify:"space-between",direction:"row"},i.a.createElement(Ce.a,{item:!0},i.a.createElement("i",{title:ue("Download"),className:G()("fa fa-download",g.actionIcon),onClick:n}),t.canWrite&&function(e,t){return!t.isLock||!t.lockedBy||e===t.lockedBy.id}(m,t)&&i.a.createElement("i",{title:ue("New version"),className:G()("fa fa-upload",g.actionIcon),onClick:o}),t.canWrite&&function(e,t){return!t.isLock||!t.lockedBy||e===t.lockedBy.id}(m,t)&&i.a.createElement(i.a.Fragment,null,t.isLock?i.a.createElement("i",{title:ue("Unlock"),className:G()("fa fa-unlock",g.actionIcon),onClick:d}):i.a.createElement("i",{title:ue("Lock"),className:G()("fa fa-lock",g.actionIcon),onClick:l}))),i.a.createElement(Ce.a,{item:!0},t.isLock&&t.lockedBy&&m!==t.lockedBy.id&&i.a.createElement("i",{className:G()("fa fa-envelope",g.actionIcon),onClick:u}))),i.a.createElement(Ce.a,null,i.a.createElement(te.a,{onClick:h,className:g.getVersionButton,variant:"outlined"},ue("Permissions"))),i.a.createElement(Ce.a,{container:!0,wrap:"nowrap"},i.a.createElement(oa.a,{className:g.formControl},i.a.createElement(en.a,{id:"tags-mutiple-chip-label",shrink:!0},ue("Tags")),i.a.createElement(na.a,{id:"tags-mutiple-chip",value:S,onChange:W,input:i.a.createElement(ae.a,{id:"select-multiple-chip"}),renderValue:function(e){return i.a.createElement("div",{className:g.chips},e.map((function(e){return i.a.createElement(St.a,{size:"small",key:e.id,label:i.a.createElement("div",{className:g.chipContent},i.a.createElement(ge.a,{noWrap:!0,variant:"body1"},e.name),i.a.createElement(an.a,{className:g.chipClose,onClick:function(t){return A(t,e)}})),className:g.chip})})))},MenuProps:bn},v.map((function(e){var t=e.tagList,a=Object(Nt.a)(e,["tagList"]);return([Object(c.a)({},a)].concat(Object(x.a)(t))||[]).map((function(e){return i.a.createElement(X.a,{key:e.id,value:e},a.id===e.id?e.name:"".concat(a.name," > ").concat(e.name))}))}))))),i.a.createElement(Ce.a,null,i.a.createElement(te.a,{variant:"outlined",className:g.getVersionButton,onClick:U},ue("Get versions")),M?i.a.createElement(Ce.a,{item:!0,container:!0,justify:"center"},i.a.createElement(rn.a,{className:g.syncIcon})):y.map((function(e,a){return i.a.createElement(Ce.a,{key:a,item:!0,className:g.versionListItem},i.a.createElement(Ce.a,{item:!0,xs:2},Number(e.documentVersion)),i.a.createElement(Ce.a,{item:!0,xs:6},i.a.createElement(ge.a,{title:e.metaFile&&e.metaFile.fileName,className:g.versionFileName},e.metaFile&&e.metaFile.fileName)),i.a.createElement(Ce.a,{item:!0,xs:4},t["metaFile.id"]===(e.metaFile||{}).id?i.a.createElement(ge.a,{align:"center"},ue("Current")):i.a.createElement(Ce.a,{item:!0,container:!0,justify:"space-around"},i.a.createElement("i",{title:ue("Download"),className:G()("fa fa-download",g.versionDownloadIcon),onClick:function(){return p(e)}}),t.canWrite&&i.a.createElement(te.a,{className:g.restoreButton,variant:"outlined",onClick:function(){return f(e)}},i.a.createElement(ge.a,{className:g.restoreText},ue("Restore"))))))})))),t.fileType&&i.a.createElement(mn,{document:t,open:L,onClose:_})))},gn=Object(z.a)((function(e){return{form:{display:"flex",flexDirection:"column"},input:{marginBottom:25}}})),En=new R({model:"com.axelor.apps.projectdms.db.DMSVersion"}),Cn=function(e){var t=e.onClose,a=e.open,n=e.onSave,o=e.defaultIncrement,l=e.documentMetaFileId,u=Object(r.useState)({}),d=Object(s.a)(u,2),m=d[0],f=d[1],p=gn(),v=i.a.useCallback((function(){m.file&&m.version?(n(m),f({}),t()):alert("All fields are required")}),[m,n,t]),b=i.a.useCallback((function(e){var t=e.target,a=t.name,n=t.value;f((function(e){return Object(c.a)({},e,Object(w.a)({},a,n))}))}),[]),h=i.a.useCallback((function(e){e.length&&f((function(t){return Object(c.a)({},t,{file:e})}))}),[]),g=i.a.useCallback((function(){f({}),t()}),[t]);return Object(r.useEffect)((function(){if(l){var e={_domain:"self.metaFile.id = ".concat(l)};En.search({fields:["documentVersion"],data:e}).then((function(e){var t=e.data,a=void 0===t?[]:t;f((function(e){return Object(c.a)({},e,{version:Number(o)+(a[0]?Number(a[0].documentVersion):0)})}))}))}}),[o,l]),i.a.createElement(Q.a,{onClose:g,"aria-labelledby":"simple-dialog-title",open:a},i.a.createElement($.a,null,ue("New version")),i.a.createElement(Z.a,{className:p.form},i.a.createElement(ae.a,{placeholder:ue("New file"),className:p.input,type:"File",onChange:function(e){return h(e.target.files)}}),i.a.createElement(ae.a,{className:p.input,type:"number",name:"version",value:m.version,onChange:b,placeholder:ue("Version")})),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:v,variant:"contained",color:"primary"},ue("Save")),i.a.createElement(te.a,{onClick:g,variant:"outlined"},ue("Cancel"))))},On=Object(z.a)((function(e){return{dmsTreeContainer:{width:300,paddingRight:10,maxHeight:"35%",overflow:"auto"},treeElement:{padding:"0px 5px",display:"flex"},treeElementContainer:{cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, .05)"}},selected:{backgroundColor:"rgba(0, 0, 0, .03)"},expandIcon:{marginTop:3,cursor:"pointer"},folderIcon:{fontSize:"1.3rem",marginRight:5},root:{padding:"2px !important"},tagName:{paddingTop:5,paddingLeft:3},noChildElement:{paddingLeft:20},tagTitle:{paddingLeft:20,fontWeight:"bold"}}}));function yn(e){var t=On(),a=!1===e.isCollapse?_.a:W.a;return i.a.createElement(a,{className:t.expandIcon,onClick:e.onClick})}var jn=function(e){var t=e.data,a=e.selectedTags,n=e.onChecked,o=On(),l=Object(r.useState)([]),c=Object(s.a)(l,2),u=c[0],d=c[1],m=i.a.useCallback((function(e,t){var a=t.id;e&&e.stopPropagation();var n=!0;d((function(e){var t=e.indexOf(a);return n&&(n=!1,t>-1?e.splice(t,1):e.push(a)),Object(x.a)(e)}))}),[]),f=i.a.useCallback((function(e,t){e.stopPropagation();var a=[t.id];t.tagList&&a.push.apply(a,Object(x.a)(t.tagList.map((function(e){return e.id})))),n(a)}),[n]);return i.a.createElement("div",{className:o.dmsTreeContainer},t.length>0&&i.a.createElement(ge.a,{className:o.tagTitle,variant:"subtitle1"},ue("Tags")),function e(t,n){return t.map((function(t,r){var l=t.tagList||[],c=u.includes(t.id),s=Boolean(l.length);return i.a.createElement(i.a.Fragment,{key:r},i.a.createElement("div",{className:G()(o.treeElementContainer)},i.a.createElement("div",{className:G()(o.treeElement,Object(w.a)({},o.noChildElement,!s)),style:{marginLeft:15*n},onClick:function(e){return f(e,t)}},s&&i.a.createElement(yn,{onClick:function(e){return m(e,t)},isCollapse:c}),i.a.createElement($t.a,{checked:a.includes(t.id),classes:{root:o.root}}),i.a.createElement(ge.a,{className:o.tagName},t.name))),!c&&e(l,n+1))}))}(t,1))},kn=new R({model:"com.axelor.apps.base.db.App"}),xn=new R({model:"com.axelor.apps.base.db.AppProject"}),wn=new R({model:"com.axelor.apps.project.db.Project"}),Nn=new R({model:"com.axelor.dms.db.DMSFile"}),Sn=new R({model:"com.axelor.meta.db.MetaFilter"}),In=new R({model:"com.axelor.dms.db.DMSPermission"}),Fn=new R({model:"com.axelor.meta.db.MetaJsonField"});function Tn(){return Ln.apply(this,arguments)}function Ln(){return(Ln=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={_domain:"self.code = 'project'"},e.abrupt("return",kn.search({data:t}).then((function(e){return Object(s.a)(e.data,1)[0]})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pn(e,t){return Dn.apply(this,arguments)}function Dn(){return(Dn=Object(k.a)(j.a.mark((function e(t,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xn.fetch(t,{fields:a}).then((function(e){return Object(s.a)(e.data,1)[0]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bn(){return(Bn=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tn().then((function(e){if(e&&e.id)return Pn(e.id,["defaultIncrement"]).then((function(e){return e&&e.defaultIncrement}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mn(){return(Mn=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a={criteria:[{fieldName:"membersUserSet.id",operator:"in",value:[t]}]},e.abrupt("return",wn.search({fields:["fullName"],data:a}).then((function(e){var t=e.data;return void 0===t?[]:t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vn(){return(Vn=Object(k.a)(j.a.mark((function e(t,a){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return n={id:t.id,version:t.version,isLock:!0,lockedBy:{id:a}},e.abrupt("return",Nn.save(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rn(){return(Rn=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t.id,version:t.version,isLock:!1,lockedBy:null},e.abrupt("return",Nn.save(a));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zn(){return(zn=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return"com.axelor.apps.projectdms.web.DMSController:sendEmail",a={data:{model:Nn.model,domain:null,context:Object(c.a)({},t)}},e.abrupt("return",Nn.action("com.axelor.apps.projectdms.web.DMSController:sendEmail",a).then((function(e){return e.status})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Un(){return(Un=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"com.axelor.meta.web.MetaFilterController:findFilters",t={data:{model:Sn.model,domain:null,context:{filterView:"dms-file-filters",_model:Sn.model}}},e.abrupt("return",Sn.action("com.axelor.meta.web.MetaFilterController:findFilters",t).then((function(e){var t=e.data;return void 0===t?[]:t})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wn(){return(Wn=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return"com.axelor.meta.web.MetaFilterController:removeFilter",a={data:{model:Sn.model,domain:null,context:Object(c.a)({},t)}},e.abrupt("return",Sn.action("com.axelor.meta.web.MetaFilterController:removeFilter",a).then((function(e){var t=e.data;return void 0===t?{}:t})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function An(){return(An=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return"com.axelor.meta.web.MetaFilterController:saveFilter",a={data:{model:Sn.model,domain:null,context:Object(c.a)({},t,{},t.name&&{name:t.name},{filterView:"dms-file-filters",filters:""})}},e.abrupt("return",Sn.action("com.axelor.meta.web.MetaFilterController:saveFilter",a).then((function(e){return e.data})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _n(){return(_n=Object(k.a)(j.a.mark((function e(t,a,n){var r,i,o,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e){return!(!e.user||!e.group)},i=a.map((function(e){if(!e.id&&r(e))return Object(c.a)({},e,{file:{id:t},value:e.value?e.value.id:null})})).filter((function(e){return e})),o={records:i},l=[],i.length>0&&l.push(In.save(o,!0)),n.length>0&&l.push(In.removeAll(n)),e.abrupt("return",Promise.all(l).then((function(e){if(i.length>0){var t=e[0].data,n=void 0===t?[]:t;return[].concat(Object(x.a)(a.filter((function(e){return e.id}))),Object(x.a)(n))}return Object(x.a)(a)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hn(){return(Hn=Object(k.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={_domain:"self.file.id = ".concat(t)},e.abrupt("return",In.search({data:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(){return(qn=Object(k.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={_domain:"self.jsonModel is null and self.model = '".concat(Nn.model,"'")},a=["type","name","model","modelField","visibleInGrid"],e.abrupt("return",Fn.search({fields:a,data:t}).then((function(e){var t=e.data;return void 0===t?[]:t})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Kn=a(379),Gn=a(377),Yn=a(378),Xn=Object(N.a)((function(e){return{collapseHandle:{padding:e.spacing(.5),display:"flex",alignItems:"center",justifyContent:"space-between"},collapseContainer:{maxHeight:200,overflow:"auto"}}}));var Jn=function(e){var t=e.children,a=e.hasData,n=Xn(),r=i.a.useState(!1),o=Object(s.a)(r,2),l=o[0],c=o[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe.a,{only:"xs"},t),i.a.createElement(Qe.a,{smUp:!0},a&&i.a.createElement("div",{className:n.collapseHandle,onClick:function(){return c((function(e){return!e}))}},i.a.createElement(ge.a,null,ue("Directory and Tags")),i.a.createElement(st.a,{size:"small"},l?i.a.createElement(Gn.a,null):i.a.createElement(Yn.a,null))),i.a.createElement(Kn.a,{classes:{container:n.collapseContainer},in:l},t)))},Qn=a(380),$n=Object(z.a)((function(e){return{form:{display:"flex",flexDirection:"column","& svg.addIcon":{cursor:"pointer",marginTop:10},"& svg.closeIcon":{marginTop:5,cursor:"pointer"}},input:{marginBottom:25},permissionView:{display:"flex",flexDirection:"row",justifyContent:"space-between"},actionButton:{textTransform:"capitalize"}}})),Zn="com.axelor.auth.db.User",er="com.axelor.auth.db.Group",tr={user:null,group:null,value:null};var ar=function(e){e.permissions;var t=e.onSave,a=e.open,n=e.onClose,r=e.fileId,o=$n(),l=i.a.useState([Object(c.a)({},tr)]),u=Object(s.a)(l,2),d=u[0],m=u[1],f=i.a.useState([]),p=Object(s.a)(f,2),v=p[0],b=p[1];i.a.useEffect((function(){(function(e){return Hn.apply(this,arguments)})(r).then((function(e){var t=e.data,a=void 0===t?[]:t;a.length>0?m(Object(x.a)(a)):m([Object(c.a)({},tr)])}))}),[r]);var h=i.a.useCallback((function(){(function(e,t,a){return _n.apply(this,arguments)})(r,d,v).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];m(Object(x.a)(e)),t(e),n()}))}),[t,v,d,r,n]),g=i.a.useCallback((function(e,t,a){m((function(n){return n[a]=Object(c.a)({},n[a],Object(w.a)({},e,t)),Object(x.a)(n)}))}),[]),E=i.a.useCallback((function(e){var t=d[e];t&&(t.id&&b((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},t)])})),m((function(t){return t.splice(e,1),0===t.length&&t.push(Object(c.a)({},tr)),Object(x.a)(t)})))}),[d]),C=i.a.useCallback((function(){var e=d[d.length-1];e.user&&e.group&&m((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},tr)])}))}),[d]),O=i.a.useCallback((function(e,t,a){var n=new R({model:t}),r=Object(c.a)({},""!==e.search&&{criteria:[{fieldName:a,operator:"like",value:e.search}]});return n.search({fields:[a],data:r}).then((function(e){var t=e.data;return void 0===t?[]:t}))}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Qe.a,{only:"xs"},i.a.createElement(Q.a,{open:a,onClose:n,maxWidth:"sm",fullWidth:!0},i.a.createElement($.a,null,ue("Permissions")),i.a.createElement(Z.a,{className:o.form},d.map((function(e,t){return i.a.createElement("div",{key:t,className:G()(o.permissionRow,o.permissionView)},i.a.createElement(ha,{readOnly:Boolean(e.id),fetchAPI:function(e){return O(e,Zn,"fullName")},isSearchable:!0,optionLabelKey:"fullName",optionValueKey:"id",name:"user",value:e.user,formControlStyle:{marginBottom:"5px",width:"30%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1,onChange:function(e){return g("user",e,t)}}),i.a.createElement(ha,{readOnly:Boolean(e.id),fetchAPI:function(e){return O(e,er,"name")},isSearchable:!0,optionLabelKey:"name",optionValueKey:"id",name:"group",value:e.group,formControlStyle:{marginBottom:"5px",width:"30%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1,onChange:function(e){return g("group",e,t)}}),i.a.createElement(ha,{readOnly:Boolean(e.id),name:"value",value:e.value,onChange:function(e){return g("value",e,t)},options:pe,formControlStyle:{marginBottom:"5px",width:"30%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1}),i.a.createElement(wt.a,{className:"closeIcon",onClick:function(){return E(t)}}))})),i.a.createElement(Qn.a,{className:"addIcon",onClick:C})),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:n,variant:"outlined",className:o.actionButton},ue("Close")),i.a.createElement(te.a,{onClick:h,variant:"contained",color:"primary",className:o.actionButton},ue("OK"))))),i.a.createElement(Qe.a,{smUp:!0},i.a.createElement(Q.a,{open:a,onClose:n,maxWidth:"sm",fullWidth:!0,fullScreen:!0,TransitionComponent:tt,transitionDuration:200},i.a.createElement($.a,null,ue("Permissions")),i.a.createElement(Z.a,{className:o.form},d.map((function(e,t){return i.a.createElement("div",{key:t,className:o.permissionView},i.a.createElement(Ce.a,{container:!0,direction:"column",className:o.permissionRow},i.a.createElement(ha,{readOnly:Boolean(e.id),fetchAPI:function(e){return O(e,Zn,"fullName")},isSearchable:!0,optionLabelKey:"fullName",optionValueKey:"id",name:"user",value:e.user,formControlStyle:{marginBottom:"5px",width:"80%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1,onChange:function(e){return g("user",e,t)}}),i.a.createElement(ha,{readOnly:Boolean(e.id),fetchAPI:function(e){return O(e,er,"name")},isSearchable:!0,optionLabelKey:"name",optionValueKey:"id",name:"group",value:e.group,formControlStyle:{marginBottom:"5px",width:"80%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1,onChange:function(e){return g("group",e,t)}}),i.a.createElement(ha,{readOnly:Boolean(e.id),name:"value",value:e.value,onChange:function(e){return g("value",e,t)},options:pe,formControlStyle:{marginBottom:"5px",width:"80%"},clearIndicatorStyle:{paddingLeft:"0 !important"},closeMenuOnScroll:!1})),i.a.createElement(wt.a,{className:o.closeIcon,onClick:function(){return E(t)}}))})),i.a.createElement(Qn.a,{className:o.addIcon,onClick:C})),i.a.createElement(ee.a,null,i.a.createElement(te.a,{onClick:n,variant:"outlined"},ue("Close")),i.a.createElement(te.a,{onClick:h,variant:"contained",color:"primary"},ue("OK"))))))},nr=Object(N.a)((function(e){var t;return{sideColumn:{border:"1px solid",width:250},contentColumn:{flexGrow:1},dmsContentContainer:Object(w.a)({display:"flex",width:"100%",position:"relative",height:"calc(100% - 50px)",marginTop:e.spacing(.5),".popup &":{height:"60vh"}},e.breakpoints.only("xs"),{flexDirection:"column"}),dmsGridContainer:(t={width:"calc(100% - 250px)"},Object(w.a)(t,e.breakpoints.only("xs"),{width:"100%"}),Object(w.a)(t,"position","relative"),Object(w.a)(t,"display","flex"),Object(w.a)(t,"overflow","hidden"),Object(w.a)(t,"flexGrow",1),Object(w.a)(t,"height","100%"),t),dmsSideTreeView:Object(w.a)({height:"100%",backgroundColor:e.palette.grey[100]},e.breakpoints.only("xs"),{height:"auto"}),fileInput:{display:"none"}}})),rr=new R({model:"com.axelor.dms.db.DMSFile"}),ir=new R({model:"com.axelor.apps.projectdms.db.DMSVersion"}),or=new R({model:"com.axelor.dms.db.DMSFileTag"}),lr=new B;function cr(e){var t=e.userInfo,a=i.a.useState(),n=Object(s.a)(a,2),o=n[0],l=n[1],u=i.a.useState({offset:0,limit:40,total:0}),d=Object(s.a)(u,2),m=d[0],f=d[1],p=i.a.useState([]),v=Object(s.a)(p,2),b=v[0],h=v[1],g=i.a.useState([]),E=Object(s.a)(g,2),C=E[0],O=E[1],y=i.a.useState([]),w=Object(s.a)(y,2),N=w[0],S=w[1],I=i.a.useState([]),F=Object(s.a)(I,2),T=F[0],L=F[1],P=i.a.useState(!1),D=Object(s.a)(P,2),B=D[0],M=D[1],V=i.a.useState("list"),R=Object(s.a)(V,2),z=R[0],U=R[1],W=i.a.useState([]),A=Object(s.a)(W,2),_=A[0],H=A[1],q=i.a.useState(),K=Object(s.a)(q,2),G=K[0],Y=K[1],X=i.a.useState(),J=Object(s.a)(X,2),Q=J[0],$=J[1],Z=i.a.useState(!1),ee=Object(s.a)(Z,2),te=ee[0],ae=ee[1],ce=i.a.useState("1.0"),se=Object(s.a)(ce,2),ue=se[0],de=se[1],me=i.a.useState([]),pe=Object(s.a)(me,2),ve=pe[0],be=pe[1],ge=i.a.useState(),Ee=Object(s.a)(ge,2),Ce=Ee[0],Oe=Ee[1],ye=i.a.useState(),je=Object(s.a)(ye,2),ke=je[0],xe=je[1],we=i.a.useState([]),Ne=Object(s.a)(we,2),Se=Ne[0],Ie=Ne[1],Fe=i.a.useState(!1),Te=Object(s.a)(Fe,2),Le=Te[0],Pe=Te[1],De=i.a.useState([]),Be=Object(s.a)(De,2),Me=Be[0],Ve=Be[1],Re=i.a.useState(),ze=Object(s.a)(Re,2),Ue=ze[0],We=ze[1],Ae=i.a.useState(),_e=Object(s.a)(Ae,2),He=_e[0],qe=_e[1],Ke=i.a.useState(),Ye=Object(s.a)(Ke,2),Xe=Ye[0],Je=Ye[1],Qe=i.a.useState([]),$e=Object(s.a)(Qe,2),Ze=$e[0],et=$e[1],tt=i.a.useState([]),at=Object(s.a)(tt,2),nt=at[0],rt=at[1],ot=i.a.useState([]),lt=Object(s.a)(ot,2),ct=lt[0],st=lt[1],ut=i.a.useRef(N),dt=i.a.useRef(),mt=nr(),ft=i.a.useCallback((function(){return t&&t["user.id"]}),[t]),pt=i.a.useCallback((function(){f({offset:0,limit:40,total:0})}),[]),vt=i.a.useCallback((function(){return Ze.map((function(e){if(e.visibleInGrid)return"".concat(e.modelField,".").concat(e.name)})).filter((function(e){return e}))}),[Ze]),bt=i.a.useCallback((function(e){h((function(t){var a=e.filter((function(e){return-1===t.findIndex((function(t){return t.id===e.id}))&&e.isDirectory}));return[].concat(Object(x.a)(t),Object(x.a)(a))}))}),[]),ht=i.a.useCallback((function(e){var t=C.find((function(t){return t.id===e}))||{};return{relatedId:t.relatedId,relatedModel:t.relatedModel}}),[C]);i.a.useEffect((function(){if(Ce){var e={criteria:[{fieldName:"projectSet.id",operator:"in",value:[Ce.id]}]};or.search({data:e,fields:["projectSet","name","color","tagList"]}).then((function(e){var t=e.data,a=void 0===t?[]:t;rt(Object(x.a)(a))}))}}),[Ce]),i.a.useEffect((function(){if(o){var e={_domain:"self.parent.id = ".concat(o," and self.isDirectory = true")},t=["fileName","parent.id","isDirectory","metaFile.sizeText","typeIcon","relatedModel","relatedId","isLock","lockedBy","metaFile.id"].concat(Object(x.a)(vt()));rr.search({data:e,fields:t}).then((function(e){var t=e.data;bt(void 0===t?[]:t)}))}}),[o,bt,vt]);var gt=m.limit,Et=m.offset;i.a.useEffect((function(){if(o){var e=[];Ue&&Ue.query&&e.push(Object(c.a)({},Ue.query)),ct.length&&e.push({fieldName:"tags.id",operator:"in",value:ct}),He&&e.push({fieldName:"favouriteUserSet.id",operator:"in",value:[t["user.id"]]}),Xe&&e.push({fieldName:"fileName",operator:"like",value:Xe});var a={_domain:"self.parent.id = ".concat(o),criteria:e,operator:"and"},n=["fileName","parent.id","isDirectory","metaFile.sizeText","typeIcon","relatedModel","relatedId","isLock","lockedBy","metaFile.id","tags","favouriteUserSet"].concat(Object(x.a)(vt()));rr.search({data:a,fields:n,limit:gt,offset:Et,sortBy:["-isDirectory","fileName"]}).then((function(e){var t=e.data;O(void 0===t?[]:t),f((function(t){return Object(c.a)({},t,{total:e.total})}))}))}}),[Ue,o,ct,Et,gt,He,t,Xe,vt]);var Ct=i.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o){var a=[];Ue&&Ue.query&&a.push(Object(c.a)({},Ue.query)),ct.length&&a.push({fieldName:"tags.id",operator:"in",value:ct}),He&&a.push({fieldName:"favouriteUserSet.id",operator:"in",value:[t["user.id"]]}),Xe&&a.push({fieldName:"fileName",operator:"like",value:Xe});var n={_domain:"self.parent.id = ".concat(o),criteria:a,operator:"and"},r=!0===e?[]:["fileName","metaFile.sizeText","typeIcon","isLock","lockedBy","metaFile.id","tags"].concat(Object(x.a)(vt())),i=["isDirectory"];rr.export({data:n,fields:r,sortBy:i})}}),[Ue,o,ct,He,t,Xe,vt]),Ot=i.a.useCallback((function(){var e=ft();e&&function(e){return Mn.apply(this,arguments)}(e).then(be)}),[ft]),yt=i.a.useCallback((function(){(function(){return qn.apply(this,arguments)})().then(et)}),[]),jt=i.a.useCallback((function(){rr.search({data:{_domain:"self.relatedModel = 'com.axelor.apps.project.db.Project' and self.relatedId = 0 and self.isDirectory = true and self.parent = null"}}).then((function(e){var t=e.data,a=void 0===t?[]:t;if(a[0])xe(a[0]);else{rr.save({relatedModel:"com.axelor.apps.project.db.Project",relatedId:0,isDirectory:!0,parent:null,fileName:"Projects"}).then((function(e){var t=e.data,a=void 0===t?[]:t;a[0]&&xe(a[0])}))}}))}),[]),kt=i.a.useCallback((function(e){if(ke&&e){var t={_domain:"self.relatedModel = 'com.axelor.apps.project.db.Project' and self.parent.id = ".concat(ke?ke.id:null," and self.isDirectory = true and self.relatedId = ").concat(e.id)},a=["fileName","parent.id","isDirectory","metaFile.sizeText","typeIcon","relatedModel","relatedId","isLock","lockedBy","metaFile.id","tags","favouriteUserSet"].concat(Object(x.a)(vt()));rr.search({fields:a,data:t}).then((function(t){var a=t.data,n=void 0===a?[]:a;if(n[0])pt(),l(n[0].id),h((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},n[0])])})),Ie([Object(c.a)({},n[0])]);else{var r={relatedModel:"com.axelor.apps.project.db.Project",relatedId:e.id,isDirectory:!0,parent:null,fileName:e.fullName};rr.save(r).then((function(e){var t=e.data,a=void 0===t?[]:t;a[0]&&(pt(),l(a[0].id),h((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},a[0],{"parent.id":a[0].parent.id})])})),Ie([Object(c.a)({},a[0],{"parent.id":a[0].parent.id})]))}))}}))}}),[ke,pt,vt]),xt=i.a.useCallback((function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue,n={metaFile:e,documentId:{id:t},documentVersion:a};return ir.save(n).then((function(e){var t=e.data;return t[0]?t[0]:null}))}),[ue]),wt=i.a.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;rr.save(e).then((function(e){var a=(e||{}).data,n=(void 0===a?[]:a)[0];if(n.id)if(xt(n.metaFile,n.id,t),t)O((function(e){var t=e.find((function(e){return e.id===n.id}));return-1!==t&&(e[t]=Object(c.a)({},n,{"metaFile.id":n.metaFile.id})),Object(x.a)(e)})),Y(Object(c.a)({},n,{"metaFile.id":n.metaFile.id}));else{var r=n.parent?n.parent.id:null;n.isDirectory&&h((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},n,{"parent.id":r})])})),O((function(e){return[].concat(Object(x.a)(e),[Object(c.a)({},n)])})),l(r)}}))}),[xt]),Nt=i.a.useCallback((function(e,t){L((function(a){var n=a.findIndex((function(e){return e.id===t}));if(-1!==n){var r=a[n].file,i=100*e/r.size;a[n]=Object(c.a)({},a[n],{progress:i})}return Object(x.a)(a)}))}),[]),St=i.a.useCallback((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.id,r=e.file,i=(ut.current||[]).find((function(e){return e.id===n}));if(!i||i.status!==ie){var o=t+1e6<r.size?t+1e6:r.size,l=r.slice(t,o),c={"X-File-Name":r.name,"X-File-Offset":Math.min(t,r.size),"X-File-Size":r.size,"X-File-Type":r.type};return a&&(c["X-File-Id"]=a),lr.upload(l,c,(function(e){Nt(o,n)})).then((function(n){if(n.id)return Promise.resolve(n);var r=a;return n.fileId&&(r=n.fileId),St(e,t+1e6,r)}))}}),[Nt]),It=i.a.useCallback(function(){var e=Object(k.a)(j.a.mark((function e(t){var a,n,r,i=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.length>1&&void 0!==i[1]?i[1]:null,L(t),M(!0),n=j.a.mark((function e(n){var r,i,l,s,u,d,m;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],e.next=3,St(r);case 3:(i=e.sent)&&i.id&&(a?(l={metaFile:{id:i.id},id:G.id,version:G.version},wt(l,a)):(s=ht(o),u=s.relatedId,d=s.relatedModel,m=Object(c.a)({metaFile:{id:i.id},fileName:i.fileName,tags:[]},o&&Number(o)>0?{parent:{id:o}}:{},{},u&&d?{relatedId:u,relatedModel:d}:{}),wt(m)),L((function(e){var t=e.findIndex((function(e){return e.id===r.id}));return-1!==t&&(e[t].status=re),Object(x.a)(e)})));case 5:case"end":return e.stop()}}),e)})),r=0;case 5:if(!(r<t.length)){e.next=10;break}return e.delegateYield(n(r),"t0",7);case 7:r++,e.next=5;break;case 10:L((function(e){return e.filter((function(e){return e.status!==re}))})),S([]),M(!1);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ht,St,o,wt,G]),Ft=i.a.useCallback((function(e){L((function(t){var a=t.findIndex((function(t){return t.id===e}));return-1!==a&&t[a].status!==re&&(t[a]=Object(c.a)({},t[a],{status:ie})),Object(x.a)(t)}))}),[]),Tt=i.a.useCallback((function(e){var t=Object(x.a)(T),a=t.findIndex((function(t){return t.id===e}));-1!==a&&t[a].status!==re&&(t[a]=Object(c.a)({},t[a],{status:ne})),ut.current=t}),[T]),Lt=i.a.useCallback((function(e){var t=Array.prototype.slice.call(e).slice(0).map((function(e,t){return{file:e,id:t,progress:0,status:ne}}));S(t)}),[]),Pt=i.a.useCallback((function(e){U(e)}),[]),Dt=i.a.useCallback((function(e,t){t?(H((function(t){var a=t.findIndex((function(t){return t.id===e.id}));return-1===a?t.push(Object(c.a)({},e)):t.splice(a,1),Object(x.a)(t)})),Y()):(Y(e),H([e]))}),[]),Bt=Object(r.useCallback)((function(){H((function(e){return e.filter((function(e){return e.id!==G.id}))})),Y(void 0)}),[G]),Mt=i.a.useCallback((function(){lr.download(G)}),[G]),Vt=i.a.useCallback((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=e.data,n=void 0===a?[]:a;n[0]&&(t&&Y(Object(c.a)({},n[0])),O((function(e){var t=e.findIndex((function(e){return e.id===n[0].id}));return t&&(e[t]=Object(c.a)({},n[0],{"parent.id":n[0].parent.id})),Object(x.a)(e)})))}),[]),Rt=i.a.useCallback((function(){(function(e,t){return Vn.apply(this,arguments)})(G,ft()).then(Vt)}),[G,ft,Vt]),zt=i.a.useCallback((function(){(function(e){return Rn.apply(this,arguments)})(G).then(Vt)}),[G,Vt]),Ut=i.a.useCallback((function(){return function(e){return zn.apply(this,arguments)}(G).then((function(e){return 0===e&&alert("Mail sent to the user")}))}),[G]),Wt=i.a.useCallback((function(e){pt(),Ie(function(e,t){var a=[],n=e;do{a.push(Object(c.a)({},n)),n=t.find((function(e){return e.id===n["parent.id"]}))}while(n);return a.reverse()}(e,b)),l(e.id)}),[pt,b]),At=i.a.useCallback((function(e){return function(e){return An.apply(this,arguments)}(e).then((function(e){if(e.id)return Ve((function(t){var a=t.findIndex((function(t){return t.id===e.id}));return-1===a?t.push(Object(c.a)({},e)):t[a]=Object(c.a)({},e),Object(x.a)(t)})),e}))}),[]),_t=i.a.useCallback((function(){(function(){return Un.apply(this,arguments)})().then(Ve)}),[]),Ht=i.a.useCallback((function(e){return function(e){return Wn.apply(this,arguments)}(e).then((function(e){if(e.name)return Ve((function(t){var a=t.findIndex((function(t){return t.name===e.name}));return-1!==a&&t.splice(a,1),Object(x.a)(t)})),e}))}),[]),qt=i.a.useCallback((function(e){$(e),O((function(t){return t.sort(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(a,n){if(!a.hasOwnProperty(e)||!n.hasOwnProperty(e))return 0;var r="string"===typeof a[e]?a[e].toUpperCase():a[e]||"",i="string"===typeof n[e]?n[e].toUpperCase():n[e]||"",o=0;return r>i?o=1:r<i&&(o=-1),"desc"===t?-1*o:o}}(le(e),oe(e))),Object(x.a)(t)}))}),[]),Kt=i.a.useCallback((function(e){ae(e)}),[]),Gt=i.a.useCallback((function(e){var t=Array.prototype.slice.call(e.file).slice(0).map((function(e,t){return{file:e,id:t,progress:0,status:ne}}));It(Object(x.a)(t),e.version)}),[It]),Yt=i.a.useCallback((function(e){var t={version:G.version,id:G.id,metaFile:{id:e.metaFile.id}};rr.save(t).then((function(e){var t=e.data,a=void 0===t?[]:t;if(a[0]){var n=a[0].metaFile,r=void 0===n?{}:n;O((function(e){var t=e.findIndex((function(t){return t.id===e[0].id}));return-1!==t&&(e[t]=Object(c.a)({},e[0],{"metaFile.id":r.id})),Object(x.a)(e)})),Y(Object(c.a)({},a[0],{"metaFile.id":r.id}))}}))}),[G]),Xt=i.a.useCallback((function(e){var t=e.metaFile,a=void 0===t?{}:t;a.id&&lr.metaFileDownload(a)}),[]),Jt=i.a.useCallback((function(e){Array.isArray(e.query)||(pt(),We(e))}),[pt]),Qt=i.a.useCallback((function(e){pt(),st((function(t){if(e.length>1){if(t.includes(e[0])){var a=t.filter((function(t){return!e.includes(t)}));return Object(x.a)(a)}var n=e.filter((function(e){return!t.includes(e)}));return[].concat(Object(x.a)(t),Object(x.a)(n))}var r=t.findIndex((function(t){return t===e[0]}));return-1!==r?t.splice(r,1):t.push(e[0]),Object(x.a)(t)}))}),[pt]),$t=i.a.useCallback((function(e){Oe(e),kt(e)}),[kt]),Zt=Object(r.useCallback)((function(e){var t={id:G.id,version:G.version,tags:e};rr.save(t).then((function(e){var t=e.data,a=void 0===t?[]:t;a[0]&&(Y(Object(c.a)({},a[0])),O((function(e){var t=e.findIndex((function(e){return e.id===a[0].id}));return-1!==t&&(e[t]=Object(c.a)({},a[0])),Object(x.a)(e)})))}),[])}),[G]),ea=i.a.useCallback((function(e){wt(e)}),[wt]),ta=i.a.useCallback((function(e){var t=_.findIndex((function(t){return t.id===e.id})),a=[],n=-1===t?[e.id]:_.map((function(e){return e.id}));-1===t?(a.push({id:e.id}),H([])):(a=_,H([]));var r={criteria:[{fieldName:"documentId.id",operator:"in",value:n}]};ir.search({fields:["id"],data:r}).then((function(e){var t=e.data,n=void 0===t?[]:t;ir.removeAll(n).then((function(e){rr.removeAll(a).then((function(e){var t=e.data,a=void 0===t?[]:t;if(a.length){var n=a.map((function(e){return e.id}));O((function(e){var t=e.filter((function(e){return!n.includes(e.id)}));return Object(x.a)(t)})),h((function(e){var t=e.filter((function(e){return!n.includes(e.id)}));return Object(x.a)(t)})),Y()}}))}))}))}),[_]),aa=i.a.useCallback((function(){f((function(e){var t=e.offset+e.limit;return Object(c.a)({},e,{offset:t<e.total?t:e.total})}))}),[]),na=i.a.useCallback((function(){f((function(e){var t=e.offset-e.limit;return Object(c.a)({},e,{offset:t>0?t:0})}))}),[]),ra=i.a.useCallback((function(){qe((function(e){return!e}))}),[]),ia=i.a.useCallback((function(e){var a=Object(x.a)(e.favouriteUserSet),n=a.findIndex((function(e){return e.id===t["user.id"]}));-1===n?a.push({id:t["user.id"]}):a.splice(n,1);var r={id:e.id,version:e.version,favouriteUserSet:a};rr.save(r).then((function(e){Vt(e,!1)}))}),[Vt,t]),oa=i.a.useCallback((function(e){Je(e)}),[]),la=i.a.useCallback((function(){dt.current.click()}),[]),ca=i.a.useCallback((function(){Lt(dt.current.files)}),[Lt]),sa=i.a.useCallback((function(){Ct(!0)}),[Ct]),ua=i.a.useCallback((function(){Pe(!1)}),[]),da=i.a.useCallback((function(){Pe(!0)}),[]),ma=i.a.useCallback((function(e){Y((function(t){return Object(c.a)({},t,{permissions:e})})),O((function(t){var a=t.findIndex((function(e){return e.id===G.id}));return-1!==a&&(t[a]=Object(c.a)({},t[a],{permissions:e})),Object(x.a)(t)})),h((function(t){var a=t.findIndex((function(e){return e.id===G.id}));return-1!==a&&(t[a]=Object(c.a)({},t[a],{permissions:e})),Object(x.a)(t)}))}),[G]),fa=i.a.useCallback((function(){return Ze.map((function(e){return{title:"".concat(e.name," (").concat(e.modelField,")"),name:"".concat(e.modelField,".").concat(e.name,"::text"),type:"string"}}))}),[Ze]);return i.a.useEffect((function(){ut.current=T}),[T]),i.a.useEffect((function(){N.length&&!B&&It(N)}),[N,B,It]),i.a.useEffect((function(){ft()&&(function(){return Bn.apply(this,arguments)}().then((function(e){return e&&de(e)})),_t(),jt(),Ot(),yt())}),[_t,jt,Ot,ft,yt]),i.a.createElement(i.a.Fragment,null,i.a.createElement(Za,{viewMode:z,onViewModeChange:Pt,fields:[].concat(Object(x.a)(fe),Object(x.a)(fa())),onFilter:Jt,onSave:At,onRemove:Ht,filters:Me,searchFilter:Ue,projectList:ve,selectedProject:Ce,handleSelectedProject:$t,onNext:aa,onPrev:na,pagination:m,favouriteSearch:He,onFavouriteSearch:ra,onContentSearch:oa,onOpenUpload:la,onExport:Ct,onExportAll:sa}),i.a.createElement("div",{className:mt.dmsContentContainer},i.a.createElement("div",{className:mt.dmsSideTreeView},i.a.createElement(Jn,{hasData:Boolean(o)},i.a.createElement(he,{currentFolder:o,data:b,handleFolder:Wt,onFolderCreate:ea}),i.a.createElement(jn,{currentFolder:o,data:nt,onChecked:Qt,selectedTags:ct}))),i.a.createElement("div",{className:mt.dmsGridContainer},i.a.createElement(Ge,{data:C,handleFileUpload:Lt,viewMode:z,onSelect:Dt,onFolderDoubleClick:Wt,selectedFiles:_,sortingField:Q,onSorting:qt,onDelete:ta,breadcrumb:Se,onFavouriteDocument:ia,userId:t["user.id"],customFields:Ze}),i.a.createElement(it,{droppedFiles:T,cancelUpload:Ft,retryUpload:Tt}))),i.a.createElement(hn,{document:G,onClose:Bt,onDownload:Mt,onLock:Rt,onUnlock:zt,onSendMail:Ut,userId:ft(),onNewVersion:function(){return Kt(!0)},onVersionDownload:Xt,onRestore:Yt,tagList:nt,onTagSave:Zt,onPermission:da}),i.a.createElement(Cn,{open:te,onClose:function(){return Kt(!1)},onSave:Gt,defaultIncrement:ue,documentMetaFileId:G?G["metaFile.id"]:void 0}),i.a.createElement("input",{className:mt.fileInput,type:"file",multiple:!0,ref:function(e){e&&(dt.current=e)},onChange:ca}),G&&i.a.createElement(ar,{open:Le,onClose:ua,fileId:G.id,onSave:ma}))}var sr=function(e){return i.a.createElement(Ye.a,{backend:ye.b},i.a.createElement(cr,e))},ur=new R;var dr=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.language,a=e.theme,n={};return"ar"!==t&&"he"!==t||(n.direction="rtl"),"dark"===a&&(n.palette={type:"dark"}),n}({}),t=e.direction,a=e.palette,n=i.a.useState({}),r=Object(s.a)(n,2),o=r[0],l=r[1];return i.a.useEffect((function(){ur.info().then((function(e){l(Object(c.a)({},e))}))}),[]),i.a.createElement(C,{direction:t,palette:a},i.a.createElement(sr,{userInfo:o}))};a(287);l.a.render(i.a.createElement(dr,null),document.getElementById("root"))}},[[217,1,2]]]);